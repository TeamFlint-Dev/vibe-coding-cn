# Skillå®šä¹‰è§„èŒƒ - è‡ªè¿›åŒ–ç¼–ç æ¡†æ¶

## ğŸ¯ 4ä¸ªå…ƒSkillæ€»è§ˆ

æœ¬æ¡†æ¶å®šä¹‰4ä¸ªå…ƒSkillï¼ˆMeta-Skillsï¼‰ï¼Œå®ƒä»¬ååŒå·¥ä½œå®ç°è‡ªè¿›åŒ–å¾ªç¯ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           orchestrator.skill.md             â”‚
â”‚              (æ€»è°ƒåº¦å™¨)                      â”‚
â”‚    å†³å®šä½•æ—¶è°ƒç”¨å“ªä¸ªSkillï¼Œç®¡ç†æ•´ä½“æµç¨‹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“               â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Producerâ”‚     â”‚Composerâ”‚     â”‚Learner â”‚
    â”‚ç”Ÿäº§å¼•æ“â”‚     â”‚æ‹¼è£…å¼•æ“â”‚     â”‚å­¦ä¹ å¼•æ“â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ Skillå®šä¹‰é€šç”¨æ¨¡æ¿

æ¯ä¸ªSkillæ–‡ä»¶éµå¾ªç»Ÿä¸€ç»“æ„ï¼š

```markdown
---
name: skillName
version: 1.0.0
type: meta-skill
created: 2026-01-01
last_updated: 2026-01-15
requires: 
  - ä¾èµ–çš„å…¶ä»–Skill
  - Core/skillsä¸­çš„Skill
---

# Skillåç§°

> ä¸€å¥è¯æè¿°ï¼šè¿™ä¸ªSkillåšä»€ä¹ˆ

## ä½•æ—¶è§¦å‘

[è§¦å‘æ¡ä»¶]

## è¾“å…¥

- è¾“å…¥1ï¼šæè¿°
- è¾“å…¥2ï¼šæè¿°

## è¾“å‡º

- è¾“å‡º1ï¼šæè¿°
- è¾“å‡º2ï¼šæè¿°

## å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼š[æ­¥éª¤å]
[è¯¦ç»†æè¿°]

### æ­¥éª¤2ï¼š[æ­¥éª¤å]
[è¯¦ç»†æè¿°]

## æ¸è¿›å¼æŠ«éœ²ç­–ç•¥

### è¯»å–ç´¢å¼•é…ç½®
[å¦‚ä½•è¯»å–å’Œè§£æç´¢å¼•]

### æŠ«éœ²å†³ç­–
[æ ¹æ®æƒé‡å†³å®šæŠ«éœ²ä»€ä¹ˆ]

### æŠ«éœ²å†…å®¹
[å…·ä½“æŠ«éœ²çš„ä¸Šä¸‹æ–‡]

## ä¸å…¶ä»–Skillçš„å…³ç³»

- è°ƒç”¨ï¼š[è¢«è°è°ƒç”¨]
- ä¾èµ–ï¼š[ä¾èµ–å“ªäº›Skill]
- è¾“å‡ºç»™ï¼š[è¾“å‡ºç»™è°]

## æˆåŠŸæ ‡å‡†

[å¦‚ä½•åˆ¤æ–­æ‰§è¡ŒæˆåŠŸ]

## ç¤ºä¾‹æ‰§è¡Œ

[å®Œæ•´çš„æ‰§è¡Œç¤ºä¾‹]
```

## ğŸ¼ orchestrator.skill.md - æ€»è°ƒåº¦å™¨

### å®Œæ•´å®šä¹‰

```markdown
---
name: orchestrator
version: 1.0.0
type: meta-skill
created: 2026-01-01
requires: []
---

# Orchestrator - æ€»è°ƒåº¦å™¨

> ç³»ç»Ÿçš„å¤§è„‘ï¼Œå†³å®šåœ¨ä»€ä¹ˆé˜¶æ®µè°ƒç”¨å“ªä¸ªSkill

## ä½•æ—¶è§¦å‘

- ç³»ç»Ÿå¯åŠ¨æ—¶
- ç”¨æˆ·å‘èµ·æ–°éœ€æ±‚æ—¶
- æ¯ä¸ªSkillæ‰§è¡Œå®Œæ¯•å

## è¾“å…¥

- **ç”¨æˆ·éœ€æ±‚**ï¼šæ˜ç¡®çš„ä»»åŠ¡æè¿°
- **ç³»ç»ŸçŠ¶æ€**ï¼š`.state/phase.json`
- **è¦†ç›–æƒ…å†µ**ï¼š`.state/coverage.json`

## è¾“å‡º

- **æ‰§è¡Œè®¡åˆ’**ï¼šSkillè°ƒç”¨åºåˆ—
- **é˜¶æ®µæ›´æ–°**ï¼šæ›´æ–°`.state/phase.json`

## å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼šè¯»å–ç³»ç»ŸçŠ¶æ€

\`\`\`python
state = read_json('.state/phase.json')
coverage = read_json('.state/coverage.json')

current_phase = state['current_phase']
# "production" | "composition" | "learning"
\`\`\`

### æ­¥éª¤2ï¼šåˆ¤æ–­å½“å‰é˜¶æ®µ

\`\`\`python
if current_phase == "production":
    if coverage['coverage_rate'] < 0.90:
        # ç»§ç»­ç”Ÿäº§å¾ªç¯
        return call_producer()
    else:
        # åˆ‡æ¢åˆ°æ‹¼è£…é˜¶æ®µ
        return transition_to('composition')

elif current_phase == "composition":
    if user_has_new_requirement():
        return call_composer()
    else:
        return wait_for_requirement()

elif current_phase == "learning":
    return call_learner()
\`\`\`

### æ­¥éª¤3ï¼šè°ƒç”¨ç›¸åº”Skill

\`\`\`python
if action == 'produce':
    result = producer.run(task)
    learner.analyze(result)  # æ¯æ¬¡äº§å‡ºåç«‹å³å­¦ä¹ 
    
elif action == 'compose':
    result = composer.run(requirement)
    
elif action == 'learn':
    result = learner.run(history)
\`\`\`

### æ­¥éª¤4ï¼šæ›´æ–°ç³»ç»ŸçŠ¶æ€

\`\`\`python
update_state({
    'cycle_count': state['cycle_count'] + 1,
    'last_action': action,
    'last_updated': now()
})
\`\`\`

## æ¸è¿›å¼æŠ«éœ²ç­–ç•¥

Orchestratoræœ¬èº«**ä¸ç›´æ¥æŠ«éœ²ä¸Šä¸‹æ–‡**ï¼Œè€Œæ˜¯ï¼š

1. è¯»å–ç´¢å¼•é…ç½®
2. å°†ç´¢å¼•ä¼ é€’ç»™Producer/Composer/Learner
3. ç”±å„Skillæ‰§è¡Œå…·ä½“çš„æŠ«éœ²ç­–ç•¥

## ä¸å…¶ä»–Skillçš„å…³ç³»

- **è°ƒç”¨è€…**ï¼šç”¨æˆ·ã€ç³»ç»Ÿå®šæ—¶å™¨
- **è¢«è°ƒç”¨è€…**ï¼šProducerã€Composerã€Learner
- **æ•°æ®æµ**ï¼šçŠ¶æ€ç®¡ç† â†’ å†³ç­– â†’ è°ƒç”¨å­Skill

## æˆåŠŸæ ‡å‡†

- èƒ½æ ¹æ®çŠ¶æ€æ­£ç¡®å†³ç­–
- é˜¶æ®µè½¬æ¢é€»è¾‘æ¸…æ™°
- å¾ªç¯è®¡æ•°å‡†ç¡®

## ç¤ºä¾‹æ‰§è¡Œ

\`\`\`
ç”¨æˆ·ï¼šå¼€å§‹ç”Ÿäº§å¾ªç¯

Orchestrator:
  1. è¯»å– .state/phase.json
     current_phase = "production"
     cycle_count = 0
     coverage = 0.00
     
  2. åˆ¤æ–­ï¼šcoverage < 0.90ï¼Œç»§ç»­ç”Ÿäº§
  
  3. è°ƒç”¨ Producer:
     task = "Generate HealthComponent"
     
  4. Producerè¿”å›ï¼š
     output = "HealthComponent.verse"
     quality = 0.65
     
  5. ç«‹å³è°ƒç”¨ Learner:
     åˆ†æäº§å‡ºï¼Œæ›´æ–°ç´¢å¼•
     
  6. æ›´æ–°çŠ¶æ€ï¼š
     cycle_count = 1
     coverage = 0.01 (1/150èƒ½åŠ›ç‚¹)
     
  7. è¿”å›ï¼šæˆåŠŸï¼Œå‡†å¤‡ä¸‹ä¸€è½®
\`\`\`
```

## ğŸ­ producer.skill.md - ç”Ÿäº§å¼•æ“

### å®Œæ•´å®šä¹‰

```markdown
---
name: producer
version: 1.0.0
type: meta-skill
created: 2026-01-01
requires:
  - Core/skills/programming/verseDev/*
---

# Producer - ä»£ç ç§¯æœ¨ç”Ÿäº§å¼•æ“

> æ¢ç´¢UEFNèƒ½åŠ›è¾¹ç•Œï¼Œç³»ç»ŸåŒ–ç”Ÿäº§ä»£ç ç§¯æœ¨

## ä½•æ—¶è§¦å‘

- è¦†ç›–ç‡ < ç›®æ ‡ï¼ˆå¦‚90%ï¼‰
- Orchestratorå¤„äºproductioné˜¶æ®µ

## è¾“å…¥

- **èƒ½åŠ›åœ°å›¾**ï¼š`knowledge/uefn/capability-map.json`
- **ç´¢å¼•é…ç½®**ï¼š`.state/indices/*`
- **å·²è¦†ç›–èƒ½åŠ›**ï¼š`.state/coverage.json`

## è¾“å‡º

- **ä»£ç æ¨¡å—**ï¼š`assets/modules/[category]/[ModuleName].verse`
- **å…ƒæ•°æ®**ï¼š`assets/modules/[category]/metadata.json`
- **è´¨é‡è¯„åˆ†**ï¼šä¾›Learneråˆ†æ

## å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼šé€‰æ‹©å¾…æ¢ç´¢èƒ½åŠ›

\`\`\`python
capability_map = read_json('knowledge/uefn/capability-map.json')
coverage = read_json('.state/coverage.json')

# ç­›é€‰æœªè¦†ç›–çš„é«˜ä¼˜å…ˆçº§èƒ½åŠ›
uncovered = [
    cap for cap in capability_map['capabilities']
    if cap['id'] not in coverage['covered']
]

# æŒ‰ä¼˜å…ˆçº§å’Œéš¾åº¦æ’åº
sorted_caps = sort_by(uncovered, 
    key=lambda c: (c['priority'], -c['difficulty'])
)

next_capability = sorted_caps[0]
# ä¾‹å¦‚ï¼š{"id": "player_health", "name": "ç©å®¶å¥åº·ç®¡ç†"}
\`\`\`

### æ­¥éª¤2ï¼šè¯»å–ç´¢å¼•é…ç½®

\`\`\`python
feature_weights = read_json('.state/indices/feature-weights.json')
# {
#   "zero_coupling": 0.92,
#   "modularity": 0.85,
#   "naming": 0.65
# }

example_index = read_json('.state/indices/example-index.json')
pattern_index = read_json('.state/indices/pattern-index.json')
\`\`\`

### æ­¥éª¤3ï¼šæ¸è¿›å¼æŠ«éœ²ä¸Šä¸‹æ–‡

\`\`\`python
context = []

# 3.1 æŠ«éœ²æ¨¡å¼æ–‡æ¡£ï¼ˆæŒ‰æƒé‡ï¼‰
for feature, weight in sorted(feature_weights.items(), 
                               key=lambda x: x[1], 
                               reverse=True):
    if weight >= 0.85:
        # å®Œæ•´æŠ«éœ²
        pattern_file = pattern_index[feature]['file']
        context.append(read_file(f'knowledge/patterns/{pattern_file}'))
        
    elif weight >= 0.70:
        # è¯¦ç»†æ‘˜è¦
        context.append(get_pattern_summary(feature))
        
    elif weight >= 0.50:
        # ç®€è¦æåŠ
        context.append(get_pattern_brief(feature))

# 3.2 æŠ«éœ²ç›¸å…³æ¡ˆä¾‹
for feature, weight in feature_weights.items():
    if weight >= 0.80:
        excellent_examples = example_index['by_feature'][feature]['excellent']
        for ex in excellent_examples[:3]:  # æœ€å¤š3ä¸ª
            context.append(read_file(f'knowledge/examples/excellent/{ex}'))

# 3.3 æŠ«éœ²APIæ‘˜è¦
apis = next_capability['apis']
for api in apis:
    context.append(get_api_doc(api))
\`\`\`

### æ­¥éª¤4ï¼šè°ƒç”¨Agentç”Ÿæˆä»£ç 

\`\`\`python
prompt = f"""
åŸºäºä»¥ä¸‹ä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆä¸€ä¸ªå®ç°"{next_capability['name']}"çš„Verseç»„ä»¶ã€‚

è¦æ±‚ï¼š
- æ¶æ„ï¼šSceneGraph L3 Component Layer
- éµå¾ªä»¥ä¸‹ç‰¹å¾ï¼ˆæŒ‰é‡è¦æ€§æ’åºï¼‰ï¼š
  {format_features_by_weight(feature_weights)}

ä¸Šä¸‹æ–‡ï¼š
{join(context)}

ç”Ÿæˆï¼š{next_capability['name']}Component.verse
"""

code = agent.generate(prompt)
\`\`\`

### æ­¥éª¤5ï¼šä¿å­˜ä»£ç å’Œå…ƒæ•°æ®

\`\`\`python
output_path = f"assets/modules/{next_capability['category']}/{next_capability['name']}Component.verse"
write_file(output_path, code)

metadata = {
    "module": f"{next_capability['name']}Component",
    "capability_id": next_capability['id'],
    "cycle_produced": current_cycle,
    "disclosed_context_tokens": count_tokens(context),
    "feature_weights_used": feature_weights
}
write_json(f"{output_path}.metadata.json", metadata)
\`\`\`

### æ­¥éª¤6ï¼šè¯„ä¼°è´¨é‡

\`\`\`python
quality_score = evaluate_code_quality(code, feature_weights)
# è¿”å›ï¼š0.87

feature_scores = {}
for feature in feature_weights.keys():
    feature_scores[feature] = evaluate_feature(code, feature)
    # ä¾‹å¦‚ï¼š{"zero_coupling": 0.95, "modularity": 0.90}
\`\`\`

## æ¸è¿›å¼æŠ«éœ²ç­–ç•¥

### æŠ«éœ²å†³ç­–çŸ©é˜µ

| ç‰¹å¾æƒé‡ | æ¨¡å¼æ–‡æ¡£ | æ¡ˆä¾‹æ•°é‡ | æ€»tokens |
|---------|---------|---------|---------|
| 0.85-1.0 | å®Œæ•´æ–‡æ¡£(1500å­—) | 3ä¸ªä¼˜ç§€æ¡ˆä¾‹ | ~3000 |
| 0.70-0.85 | è¯¦ç»†æ‘˜è¦(400å­—) | 2ä¸ªæ¡ˆä¾‹ | ~1500 |
| 0.50-0.70 | ç®€è¦è¯´æ˜(100å­—) | 1ä¸ªæ¡ˆä¾‹ | ~500 |
| < 0.50 | ä¸æŠ«éœ² | 0ä¸ª | 0 |

### æŠ«éœ²é¡ºåº

1. **é«˜æƒé‡ç‰¹å¾çš„æ¨¡å¼** ï¼ˆæƒé‡é™åºï¼‰
2. **ç›¸å…³çš„ä¼˜ç§€æ¡ˆä¾‹** ï¼ˆæŒ‰ç‰¹å¾åŒ¹é…åº¦ï¼‰
3. **APIå‚è€ƒæ–‡æ¡£** ï¼ˆæŒ‰ä½¿ç”¨é¢‘ç‡ï¼‰

### æŠ«éœ²ä¸Šä¸‹æ–‡ç¤ºä¾‹

\`\`\`
# ç´¢å¼•é…ç½®
{
  "zero_coupling": 0.92,
  "modularity": 0.85,
  "naming": 0.65
}

# å®é™…æŠ«éœ²å†…å®¹
1. patterns/zero-coupling.md (å®Œæ•´, 1500å­—)
   + 3ä¸ªä¼˜ç§€æ¡ˆä¾‹ (600å­—)
   
2. patterns/modularity.md (æ‘˜è¦, 400å­—)
   + 2ä¸ªæ¡ˆä¾‹ (400å­—)
   
3. å‘½åè§„èŒƒ (ç®€è¦, 100å­—)

æ€»è®¡ï¼š~3000å­—ï¼ŒAgentèƒ½å……åˆ†å¸æ”¶
\`\`\`

## ä¸å…¶ä»–Skillçš„å…³ç³»

- **è¢«è°ƒç”¨**ï¼šOrchestrator
- **ä¾èµ–**ï¼šCore/skills/programming/verseDev
- **è¾“å‡ºç»™**ï¼šLearnerï¼ˆè´¨é‡åˆ†æï¼‰ã€Composerï¼ˆç§¯æœ¨åº“ï¼‰

## æˆåŠŸæ ‡å‡†

- ç”Ÿæˆçš„ä»£ç ç¬¦åˆVerseè¯­æ³•
- è´¨é‡è¯„åˆ† >= 0.60ï¼ˆåˆæœŸï¼‰æˆ– >= 0.85ï¼ˆåæœŸï¼‰
- è¦†ç›–äº†ç›®æ ‡èƒ½åŠ›ç‚¹

## ç¤ºä¾‹æ‰§è¡Œ

\`\`\`
ä»»åŠ¡ï¼šç”Ÿæˆç©å®¶å¥åº·ç®¡ç†ç»„ä»¶

Producer:
  1. é€‰æ‹©èƒ½åŠ›ï¼šplayer_health
  
  2. è¯»å–ç´¢å¼•ï¼š
     zero_coupling: 0.92
     modularity: 0.85
     naming: 0.65
     
  3. æŠ«éœ²ä¸Šä¸‹æ–‡ï¼š
     âœ“ zero-coupling.md (å®Œæ•´)
     âœ“ 3ä¸ªä¼˜ç§€æ¡ˆä¾‹
     âœ“ modularityæ‘˜è¦
     âœ“ 2ä¸ªæ¡ˆä¾‹
     âœ“ å‘½åè§„èŒƒç®€è¦
     â†’ æ€»è®¡ 3000 tokens
     
  4. Agentç”Ÿæˆï¼š
     HealthComponent.verse (120è¡Œ)
     
  5. ä¿å­˜ï¼š
     assets/modules/health/HealthComponent.verse
     + metadata.json
     
  6. è¯„ä¼°è´¨é‡ï¼š
     overall: 0.87
     zero_coupling: 0.95
     modularity: 0.90
     naming: 0.80
     
  7. è¿”å›ï¼šæˆåŠŸï¼Œè´¨é‡0.87
\`\`\`
```

## ğŸ§© composer.skill.md - æ‹¼è£…å¼•æ“

### å®Œæ•´å®šä¹‰

```markdown
---
name: composer
version: 1.0.0
type: meta-skill
created: 2026-01-01
requires:
  - producer (é—´æ¥ï¼Œä½¿ç”¨å…¶äº§å‡º)
---

# Composer - ä»£ç ç§¯æœ¨æ‹¼è£…å¼•æ“

> æ ¹æ®çœŸå®éœ€æ±‚ï¼Œå¿«é€Ÿæ‹¼è£…å·²æœ‰ç§¯æœ¨ï¼Œèƒ¶æ°´ç¼–ç¨‹

## ä½•æ—¶è§¦å‘

- ç”¨æˆ·æå‡ºå®é™…åŠŸèƒ½éœ€æ±‚
- Orchestratorå¤„äºcompositioné˜¶æ®µ

## è¾“å…¥

- **åŠŸèƒ½éœ€æ±‚**ï¼šç”¨æˆ·æè¿°çš„å®Œæ•´åŠŸèƒ½
- **ç§¯æœ¨åº“**ï¼š`assets/modules/*`
- **ç´¢å¼•é…ç½®**ï¼š`.state/indices/example-index.json`

## è¾“å‡º

- **ç»„è£…ä»£ç **ï¼š`assets/composed/[FeatureName]/`
  - `main.verse` - ä¸»å…¥å£
  - `glue-code.verse` - èƒ¶æ°´ä»£ç 
  - `components.txt` - ç§¯æœ¨æ¸…å•
- **å¤ç”¨æŠ¥å‘Š**ï¼šç§¯æœ¨å¤ç”¨æ¯”ä¾‹

## å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼šåˆ†æéœ€æ±‚

\`\`\`python
requirement = """
å®ç°ç©å®¶æˆ˜æ–—ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š
- å¥åº·ç®¡ç†
- ä¼¤å®³è®¡ç®—
- æŠ€èƒ½é‡Šæ”¾
- æˆ˜æ–—UIåé¦ˆ
"""

# æå–å­éœ€æ±‚
sub_requirements = analyze_requirement(requirement)
# [
#   "å¥åº·ç®¡ç†",
#   "ä¼¤å®³è®¡ç®—",
#   "æŠ€èƒ½é‡Šæ”¾",
#   "æˆ˜æ–—UIåé¦ˆ"
# ]
\`\`\`

### æ­¥éª¤2ï¼šæ£€ç´¢ç§¯æœ¨åº“

\`\`\`python
modules = []
for sub_req in sub_requirements:
    # æŸ¥è¯¢å·²æœ‰ç§¯æœ¨
    matches = search_modules(sub_req)
    modules.append({
        'requirement': sub_req,
        'matches': matches,
        'status': 'found' if matches else 'missing'
    })

# ç»“æœï¼š
# [
#   {'requirement': 'å¥åº·ç®¡ç†', 'matches': ['HealthComponent.verse'], 'status': 'found'},
#   {'requirement': 'ä¼¤å®³è®¡ç®—', 'matches': ['DamageCalculator.verse'], 'status': 'found'},
#   {'requirement': 'æŠ€èƒ½é‡Šæ”¾', 'matches': [], 'status': 'missing'},
#   {'requirement': 'æˆ˜æ–—UI', 'matches': ['CombatUI.verse'], 'status': 'found'}
# ]
\`\`\`

### æ­¥éª¤3ï¼šæ¸è¿›å¼æŠ«éœ²ä¸Šä¸‹æ–‡

\`\`\`python
context = []

# 3.1 æŠ«éœ²æ‰¾åˆ°çš„ç§¯æœ¨ä»£ç 
for module in modules:
    if module['status'] == 'found':
        for match in module['matches']:
            code = read_file(f'assets/modules/{match}')
            context.append({
                'type': 'existing_module',
                'content': code,
                'reusable': True
            })

# 3.2 æŠ«éœ²ç´¢å¼•ä¸­çš„ç›¸å…³æ¡ˆä¾‹ï¼ˆç”¨äºç”Ÿæˆç¼ºå¤±ç§¯æœ¨ï¼‰
example_index = read_json('.state/indices/example-index.json')
for module in modules:
    if module['status'] == 'missing':
        scenario_key = map_requirement_to_scenario(module['requirement'])
        examples = example_index['by_scenario'].get(scenario_key, [])
        for ex in examples[:2]:
            context.append({
                'type': 'reference_example',
                'content': read_file(f'knowledge/examples/excellent/{ex}'),
                'for_generating': module['requirement']
            })

# 3.3 æŠ«éœ²é›†æˆæ¨¡å¼
context.append(read_file('knowledge/patterns/component-integration.md'))
\`\`\`

### æ­¥éª¤4ï¼šæ‹¼è£…æˆ–ç”Ÿæˆ

\`\`\`python
prompt = f"""
åŸºäºä»¥ä¸‹å·²æœ‰ç§¯æœ¨å’Œä¸Šä¸‹æ–‡ï¼Œç»„è£…ä¸€ä¸ªå®Œæ•´çš„"{requirement}"ç³»ç»Ÿã€‚

å·²æœ‰ç§¯æœ¨ï¼ˆç›´æ¥å¤ç”¨ï¼‰ï¼š
{format_existing_modules(context)}

ç¼ºå¤±åŠŸèƒ½ï¼ˆéœ€ç”Ÿæˆï¼‰ï¼š
{format_missing_modules(modules)}

å‚è€ƒæ¡ˆä¾‹ï¼š
{format_reference_examples(context)}

è¦æ±‚ï¼š
1. æœ€å¤§åŒ–å¤ç”¨å·²æœ‰ç§¯æœ¨
2. åªä¸ºç¼ºå¤±åŠŸèƒ½ç¼–å†™æ–°ä»£ç 
3. ä½¿ç”¨èƒ¶æ°´ä»£ç è¿æ¥å„ç§¯æœ¨
4. éµå¾ªé›¶è€¦åˆåŸåˆ™
"""

result = agent.compose(prompt)
\`\`\`

### æ­¥éª¤5ï¼šä¿å­˜æ‹¼è£…ç»“æœ

\`\`\`python
output_dir = f"assets/composed/PlayerCombatSystem/"
os.makedirs(output_dir, exist_ok=True)

# ä¸»å…¥å£
write_file(f"{output_dir}/main.verse", result['main'])

# èƒ¶æ°´ä»£ç ï¼ˆå¦‚æœ‰ï¼‰
if result['glue_code']:
    write_file(f"{output_dir}/glue-code.verse", result['glue_code'])

# ç§¯æœ¨æ¸…å•
components_list = format_components_list(modules)
write_file(f"{output_dir}/components.txt", components_list)

# å…ƒæ•°æ®
metadata = {
    "feature": "PlayerCombatSystem",
    "requirements": sub_requirements,
    "reused_modules": [m for m in modules if m['status'] == 'found'],
    "new_code_lines": count_lines(result['glue_code']),
    "reuse_ratio": calculate_reuse_ratio(modules, result)
}
write_json(f"{output_dir}/metadata.json", metadata)
\`\`\`

## æ¸è¿›å¼æŠ«éœ²ç­–ç•¥

### æŠ«éœ²ä¼˜å…ˆçº§

1. **å·²æœ‰ç§¯æœ¨ä»£ç **ï¼ˆå®Œæ•´æŠ«éœ²ï¼‰
2. **é›†æˆæ¨¡å¼æ–‡æ¡£**ï¼ˆå¦‚ä½•è¿æ¥ç§¯æœ¨ï¼‰
3. **ç›¸å…³å‚è€ƒæ¡ˆä¾‹**ï¼ˆç”¨äºç”Ÿæˆç¼ºå¤±ç§¯æœ¨ï¼‰

### æŠ«éœ²å†…å®¹

\`\`\`
# æ‰¾åˆ°3ä¸ªç§¯æœ¨ï¼Œç¼ºå¤±1ä¸ªç§¯æœ¨

æŠ«éœ²å†…å®¹ï¼š
1. HealthComponent.verse (å®Œæ•´ä»£ç )
2. DamageCalculator.verse (å®Œæ•´ä»£ç )
3. CombatUI.verse (å®Œæ•´ä»£ç )
4. component-integration.md (é›†æˆæ¨¡å¼)
5. æŠ€èƒ½ç³»ç»Ÿå‚è€ƒæ¡ˆä¾‹ (2ä¸ªæ¡ˆä¾‹ï¼Œç”¨äºç”ŸæˆSkillSystem)

Agentä»»åŠ¡ï¼š
- å¤ç”¨å·²æœ‰3ä¸ªç§¯æœ¨ï¼ˆ80%ä»£ç é‡ï¼‰
- ç”ŸæˆSkillSystemï¼ˆ20%ä»£ç é‡ï¼‰
- ç¼–å†™èƒ¶æ°´ä»£ç è¿æ¥å„ç§¯æœ¨
\`\`\`

## ä¸å…¶ä»–Skillçš„å…³ç³»

- **è¢«è°ƒç”¨**ï¼šOrchestratorï¼ˆç”¨æˆ·éœ€æ±‚åˆ°æ¥æ—¶ï¼‰
- **ä¾èµ–**ï¼šProducerçš„äº§å‡ºï¼ˆç§¯æœ¨åº“ï¼‰
- **è¾“å‡ºç»™**ï¼šç”¨æˆ·ï¼ˆå¯äº¤ä»˜çš„å®Œæ•´åŠŸèƒ½ï¼‰

## æˆåŠŸæ ‡å‡†

- å¤ç”¨ç‡ >= 70%
- ç”Ÿæˆçš„ç³»ç»ŸåŠŸèƒ½å®Œæ•´
- ç§¯æœ¨è¿æ¥ç¬¦åˆé›¶è€¦åˆåŸåˆ™

## ç¤ºä¾‹æ‰§è¡Œ

\`\`\`
éœ€æ±‚ï¼šå®ç°ç©å®¶æˆ˜æ–—ç³»ç»Ÿ

Composer:
  1. åˆ†æéœ€æ±‚ï¼š
     - å¥åº·ç®¡ç†
     - ä¼¤å®³è®¡ç®—
     - æŠ€èƒ½é‡Šæ”¾
     - æˆ˜æ–—UI
     
  2. æ£€ç´¢ç§¯æœ¨ï¼š
     âœ“ HealthComponent (found)
     âœ“ DamageCalculator (found)
     âœ— SkillSystem (missing)
     âœ“ CombatUI (found)
     
  3. æŠ«éœ²ä¸Šä¸‹æ–‡ï¼š
     - 3ä¸ªå·²æœ‰ç§¯æœ¨ä»£ç ï¼ˆå®Œæ•´ï¼‰
     - é›†æˆæ¨¡å¼æ–‡æ¡£
     - 2ä¸ªæŠ€èƒ½ç³»ç»Ÿå‚è€ƒæ¡ˆä¾‹
     
  4. Agentæ‹¼è£…ï¼š
     - å¤ç”¨3ä¸ªç§¯æœ¨ï¼ˆ1200è¡Œï¼‰
     - ç”ŸæˆSkillSystemï¼ˆ300è¡Œï¼‰
     - èƒ¶æ°´ä»£ç ï¼ˆ50è¡Œï¼‰
     
  5. ä¿å­˜ç»“æœï¼š
     assets/composed/PlayerCombatSystem/
     â”œâ”€ main.verse
     â”œâ”€ glue-code.verse
     â””â”€ components.txt
     
  6. å¤ç”¨æŠ¥å‘Šï¼š
     å¤ç”¨ç‡ï¼š77% (1200/1550è¡Œ)
     
  7. è¿”å›ï¼šæˆåŠŸï¼Œå¯äº¤ä»˜
\`\`\`
```

## ğŸ“ learner.skill.md - å­¦ä¹ å¼•æ“

### å®Œæ•´å®šä¹‰

```markdown
---
name: learner
version: 1.0.0
type: meta-skill
created: 2026-01-01
requires: []
---

# Learner - åé¦ˆå­¦ä¹ å¼•æ“

> åˆ†æäº§å‡ºè´¨é‡ï¼Œä¼˜åŒ–ç´¢å¼•é…ç½®ï¼Œé©±åŠ¨ç³»ç»Ÿè¿›åŒ–

## ä½•æ—¶è§¦å‘

- æ¯æ¬¡Producerç”Ÿæˆä»£ç åï¼ˆç«‹å³ï¼‰
- å®šæœŸæ‰¹é‡åˆ†æï¼ˆå¦‚æ¯10ä¸ªå¾ªç¯ï¼‰
- è´¨é‡è¯„åˆ†å‘ç”Ÿæ³¢åŠ¨æ—¶

## è¾“å…¥

- **å†å²æ•°æ®**ï¼š`data/experiences/*.json`
- **è´¨é‡è¯„åˆ†**ï¼š`data/quality-scores/scores.csv`
- **å½“å‰ç´¢å¼•**ï¼š`.state/indices/*`

## è¾“å‡º

- **æ›´æ–°çš„ç´¢å¼•**ï¼š`.state/indices/feature-weights.json`
- **å­¦ä¹ æŠ¥å‘Š**ï¼š`data/learning-reports/report-[cycle].json`

## å·¥ä½œæµç¨‹

### æ­¥éª¤1ï¼šæ”¶é›†åé¦ˆæ•°æ®

\`\`\`python
# è¯»å–æœ€è¿‘Næ¬¡è¿è¡Œçš„æ•°æ®
recent_runs = []
for i in range(1, current_cycle + 1):
    run_data = read_json(f'data/experiences/run-{i:03d}.json')
    recent_runs.append({
        'cycle': i,
        'quality_score': run_data['output']['quality_score'],
        'feature_scores': run_data['analysis']['features'],
        'weights_used': run_data['input']['indices']['feature_weights']
    })
\`\`\`

### æ­¥éª¤2ï¼šç‰¹å¾ç›¸å…³æ€§åˆ†æ

\`\`\`python
# è®¡ç®—æ¯ä¸ªç‰¹å¾ä¸è´¨é‡åˆ†æ•°çš„ç›¸å…³æ€§
correlations = {}

for feature in ['zero_coupling', 'modularity', 'naming', ...]:
    # æå–ç‰¹å¾åˆ†æ•°å’Œæ€»è´¨é‡åˆ†æ•°
    feature_scores = [r['feature_scores'][feature] for r in recent_runs]
    quality_scores = [r['quality_score'] for r in recent_runs]
    
    # è®¡ç®—Pearsonç›¸å…³ç³»æ•°
    corr = pearson_correlation(feature_scores, quality_scores)
    correlations[feature] = corr

# ç»“æœç¤ºä¾‹ï¼š
# {
#   'zero_coupling': 0.92,   # å¼ºæ­£ç›¸å…³
#   'modularity': 0.85,      # å¼ºæ­£ç›¸å…³
#   'naming': 0.65,          # ä¸­ç­‰æ­£ç›¸å…³
#   'comments': 0.30         # å¼±æ­£ç›¸å…³
# }
\`\`\`

### æ­¥éª¤3ï¼šæƒé‡æ›´æ–°ç®—æ³•

\`\`\`python
# è¯»å–å½“å‰æƒé‡
current_weights = read_json('.state/indices/feature-weights.json')

# å¹³æ»‘æ›´æ–°
LEARNING_RATE = 0.2
new_weights = {}

for feature, current_weight in current_weights.items():
    correlation = correlations[feature]
    
    # å°†ç›¸å…³ç³»æ•° [-1, 1] æ˜ å°„åˆ° [0, 1]
    normalized_corr = (correlation + 1) / 2
    
    # åŠ æƒå¹³å‡
    new_weight = (
        current_weight * (1 - LEARNING_RATE) +
        normalized_corr * LEARNING_RATE
    )
    
    # é™åˆ¶èŒƒå›´ [0.20, 0.95]
    new_weight = max(0.20, min(0.95, new_weight))
    
    new_weights[feature] = round(new_weight, 2)

# ç¤ºä¾‹ï¼š
# åŸæƒé‡: {'zero_coupling': 0.50, 'naming': 0.50}
# ç›¸å…³æ€§: {'zero_coupling': 0.92, 'naming': 0.30}
# æ–°æƒé‡: {'zero_coupling': 0.63, 'naming': 0.48}
\`\`\`

### æ­¥éª¤4ï¼šæ¡ˆä¾‹ç´¢å¼•ä¼˜åŒ–

\`\`\`python
# ç»Ÿè®¡æ¡ˆä¾‹çš„ä½¿ç”¨æ•ˆæœ
example_performance = {}

for run in recent_runs:
    disclosed_examples = run['disclosed_context']['examples']
    quality = run['quality_score']
    
    for example in disclosed_examples:
        if example not in example_performance:
            example_performance[example] = []
        example_performance[example].append(quality)

# è®¡ç®—å¹³å‡è´¨é‡
example_avg_quality = {
    ex: mean(scores)
    for ex, scores in example_performance.items()
}

# æ›´æ–°æ¡ˆä¾‹ç´¢å¼•ï¼Œæå‡é«˜è´¨é‡æ¡ˆä¾‹çš„æƒé‡
example_index = read_json('.state/indices/example-index.json')
for feature in example_index['by_feature']:
    examples = example_index['by_feature'][feature]['excellent']
    # æŒ‰å¹³å‡è´¨é‡é‡æ–°æ’åº
    examples.sort(key=lambda ex: example_avg_quality.get(ex, 0), reverse=True)
    example_index['by_feature'][feature]['excellent'] = examples

write_json('.state/indices/example-index.json', example_index)
\`\`\`

### æ­¥éª¤5ï¼šåˆ¤æ–­æ”¶æ•›

\`\`\`python
# æ£€æŸ¥è´¨é‡è¶‹åŠ¿
last_5_scores = [r['quality_score'] for r in recent_runs[-5:]]
variance = calculate_variance(last_5_scores)

# æ£€æŸ¥æƒé‡å˜åŒ–
weight_changes = sum([
    abs(new_weights[f] - current_weights[f])
    for f in new_weights
]) / len(new_weights)

is_converged = (
    variance < 0.02 and         # è´¨é‡ç¨³å®š
    weight_changes < 0.05       # æƒé‡ç¨³å®š
)

if is_converged:
    log("ç³»ç»Ÿå·²æ”¶æ•›ï¼Œç´¢å¼•ä¼˜åŒ–å®Œæˆ")
    update_phase("stable")
\`\`\`

### æ­¥éª¤6ï¼šç”Ÿæˆå­¦ä¹ æŠ¥å‘Š

\`\`\`python
report = {
    "cycle": current_cycle,
    "timestamp": now(),
    "correlations": correlations,
    "weight_changes": {
        feature: {
            "old": current_weights[feature],
            "new": new_weights[feature],
            "delta": new_weights[feature] - current_weights[feature]
        }
        for feature in new_weights
    },
    "quality_trend": {
        "last_5_avg": mean(last_5_scores),
        "variance": variance,
        "trend": "improving" if last_5_scores[-1] > last_5_scores[0] else "declining"
    },
    "is_converged": is_converged
}

write_json(f'data/learning-reports/report-{current_cycle:03d}.json', report)
\`\`\`

## æ¸è¿›å¼æŠ«éœ²ç­–ç•¥

Learner **ä¸ç›´æ¥æŠ«éœ²ä¸Šä¸‹æ–‡ç»™Agent**ï¼Œè€Œæ˜¯ï¼š

1. **åˆ†æå†å²æŠ«éœ²æ•ˆæœ**
2. **ä¼˜åŒ–ç´¢å¼•é…ç½®**
3. **å½±å“åç»­Producer/Composerçš„æŠ«éœ²ç­–ç•¥**

**é—´æ¥æŠ«éœ²**ï¼šé€šè¿‡è°ƒæ•´æƒé‡ï¼Œè®©Producer/Composerä¸‹æ¬¡æŠ«éœ²æ›´ç²¾å‡†çš„å†…å®¹ã€‚

## ä¸å…¶ä»–Skillçš„å…³ç³»

- **è¢«è°ƒç”¨**ï¼šOrchestratorï¼ˆæ¯æ¬¡Produceråï¼‰
- **è¾“å…¥æ¥æº**ï¼šProducerçš„äº§å‡ºæ•°æ®
- **è¾“å‡ºå½±å“**ï¼šä¸‹æ¬¡Producer/Composerçš„æŠ«éœ²ç­–ç•¥

## æˆåŠŸæ ‡å‡†

- æƒé‡æ›´æ–°é€»è¾‘æ­£ç¡®
- è´¨é‡è¶‹åŠ¿å‘ä¸Š
- æ”¶æ•›åˆ¤æ–­å‡†ç¡®

## ç¤ºä¾‹æ‰§è¡Œ

\`\`\`
ä»»åŠ¡ï¼šåˆ†æå‰5è½®å¾ªç¯ï¼Œä¼˜åŒ–ç´¢å¼•

Learner:
  1. æ”¶é›†æ•°æ®ï¼š
     Cycle 1: è´¨é‡0.65, zero_coupling=0.70, naming=0.60
     Cycle 2: è´¨é‡0.72, zero_coupling=0.78, naming=0.62
     ...
     Cycle 5: è´¨é‡0.80, zero_coupling=0.85, naming=0.68
     
  2. ç›¸å…³æ€§åˆ†æï¼š
     zero_coupling â†” è´¨é‡: 0.92 (å¼ºç›¸å…³)
     modularity â†” è´¨é‡: 0.85
     naming â†” è´¨é‡: 0.65
     
  3. æ›´æ–°æƒé‡ï¼š
     zero_coupling: 0.50 â†’ 0.63 (â†‘)
     modularity: 0.50 â†’ 0.57 (â†‘)
     naming: 0.50 â†’ 0.53 (â†‘)
     
  4. æ¡ˆä¾‹ç´¢å¼•ä¼˜åŒ–ï¼š
     é‡æ–°æ’åºæ¡ˆä¾‹ï¼Œæå‡é«˜è´¨é‡æ¡ˆä¾‹ä¼˜å…ˆçº§
     
  5. æ”¶æ•›æ£€æŸ¥ï¼š
     variance = 0.03 (> 0.02)
     weight_changes = 0.08 (> 0.05)
     â†’ æœªæ”¶æ•›ï¼Œç»§ç»­å¾ªç¯
     
  6. ç”ŸæˆæŠ¥å‘Šï¼š
     data/learning-reports/report-005.json
     
  7. è¿”å›ï¼šæˆåŠŸï¼Œç´¢å¼•å·²æ›´æ–°
\`\`\`
```

## ğŸ“Š Skillåä½œæµç¨‹å›¾

```
ç”¨æˆ·å‘èµ·ä»»åŠ¡
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Orchestrator       â”‚
â”‚   (åˆ¤æ–­é˜¶æ®µ)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    â”œâ”€â†’ [ç”Ÿäº§é˜¶æ®µ] â†’ Producer
    â”‚                  â”œâ”€ è¯»å–ç´¢å¼•
    â”‚                  â”œâ”€ æ¸è¿›å¼æŠ«éœ²
    â”‚                  â”œâ”€ Agentç”Ÿæˆ
    â”‚                  â””â”€ è¾“å‡ºä»£ç 
    â”‚                       â†“
    â”‚                   Learner
    â”‚                  â”œâ”€ åˆ†æè´¨é‡
    â”‚                  â”œâ”€ è®¡ç®—ç›¸å…³æ€§
    â”‚                  â””â”€ æ›´æ–°ç´¢å¼•
    â”‚
    â”œâ”€â†’ [æ‹¼è£…é˜¶æ®µ] â†’ Composer
    â”‚                  â”œâ”€ æ£€ç´¢ç§¯æœ¨
    â”‚                  â”œâ”€ æŠ«éœ²ä¸Šä¸‹æ–‡
    â”‚                  â”œâ”€ Agentæ‹¼è£…
    â”‚                  â””â”€ è¾“å‡ºç³»ç»Ÿ
    â”‚
    â””â”€â†’ [å­¦ä¹ é˜¶æ®µ] â†’ Learner
                       (æ‰¹é‡åˆ†æ)
```

## ğŸ” Skillå¯¹æ¯”æ€»ç»“

| Skill | ä¸»è¦èŒè´£ | ç´¢å¼•ä½¿ç”¨ | æŠ«éœ²ç­–ç•¥ | è¾“å‡º |
|-------|---------|---------|---------|------|
| **Orchestrator** | æµç¨‹è°ƒåº¦ | è¯»å–ä¸ä½¿ç”¨ | ä¸æŠ«éœ² | è°ƒç”¨åºåˆ— |
| **Producer** | ç”Ÿäº§ç§¯æœ¨ | è¯»å–å¹¶ä¾èµ– | å®Œæ•´æŠ«éœ² | ä»£ç æ¨¡å— |
| **Composer** | æ‹¼è£…ç§¯æœ¨ | è¯»å–å¹¶ä¾èµ– | é€‰æ‹©æ€§æŠ«éœ² | å®Œæ•´ç³»ç»Ÿ |
| **Learner** | ä¼˜åŒ–ç´¢å¼• | åˆ†æå¹¶æ›´æ–° | ä¸æŠ«éœ² | æ–°ç´¢å¼•é…ç½® |

## ğŸ“– ä¸‹ä¸€æ­¥

- **ç†è§£ç´¢å¼•æœºåˆ¶** â†’ [05-index-mechanism.md](./05-index-mechanism.md)
- **æŸ¥çœ‹å®Œæ•´å·¥ä½œæµ** â†’ [06-workflow.md](./06-workflow.md)
- **å­¦ä¹ è¿›åŒ–æœºåˆ¶** â†’ [07-evolution-mechanism.md](./07-evolution-mechanism.md)

---

**è¿”å›** â†’ [æ¡†æ¶æ–‡æ¡£é¦–é¡µ](./README.md)
