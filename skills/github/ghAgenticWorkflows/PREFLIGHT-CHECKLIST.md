# GitHub Agentic Workflows å‰ç½®æ£€æŸ¥æ¸…å•

> **ç”¨é€”**: å¼€å§‹ gh-aw ç›¸å…³ä»»åŠ¡å‰ï¼Œé€é¡¹æ£€æŸ¥ä»¥é¿å…è¸©å‘
>
> **æ¥æº**: æœ¬æ¸…å•ä»å®é™…è¸©å‘ä¸­æŒç»­æ²‰æ·€ï¼Œæ¯æ¡éƒ½æœ‰å¯¹åº”çš„å¤±è´¥æ¡ˆä¾‹ç¼–å·

---

## âš¡ å¿«é€Ÿæ£€æŸ¥ï¼ˆæ¯æ¬¡å¿…çœ‹ï¼‰

- [ ] è¯»å– `CAPABILITY-BOUNDARIES.md` ç¡®è®¤ä»»åŠ¡å¯è¡Œæ€§
- [ ] ç¡®è®¤ workflow æ–‡ä»¶ä½äº `.github/workflows/*.md`
- [ ] è¿è¡Œ `gh aw compile` éªŒè¯è¯­æ³•

---

## ğŸ” æƒé™ä¸å®‰å…¨

### Permissions é…ç½®

- [ ] å£°æ˜çš„ permissions æ»¡è¶³ä»»åŠ¡éœ€æ±‚
- [ ] å†™æ“ä½œä½¿ç”¨ safe-outputs è€Œéç›´æ¥æƒé™
  - æ¥æº: [FC-001](FAILURE-CASES.md#fc-001) (å¾…æ·»åŠ )
  - éªŒè¯: æ£€æŸ¥ frontmatter ä¸­æ˜¯å¦æœ‰ `safe-outputs` é…ç½®

### Token æƒé™

- [ ] è·¨ä»“åº“æ“ä½œä½¿ç”¨ PAT è€Œé GITHUB_TOKEN
  - æ¥æº: å®˜æ–¹æ–‡æ¡£
  - éªŒè¯: `github-token: ${{ secrets.PAT }}`

- [ ] Fine-grained PAT æƒé™å®Œæ•´ï¼ˆä½¿ç”¨è‡ªå®šä¹‰ Token æ—¶ï¼‰
  - æ¥æº: [FC-003](FAILURE-CASES.md#fc-003-create-issue-safe-output-è¿”å›-404-not-found)
  - æ£€æŸ¥é¡¹:
    - [ ] Token æœªè¿‡æœŸ
    - [ ] Token å·²æˆæƒè®¿é—®ç›®æ ‡ä»“åº“
    - [ ] `Issues: Read and write`ï¼ˆåˆ›å»º/æ›´æ–° Issue æ—¶å¿…éœ€ï¼‰
    - [ ] `Contents: Read and write`ï¼ˆåˆ›å»º PR/ä¿®æ”¹æ–‡ä»¶æ—¶å¿…éœ€ï¼‰
  - éªŒè¯: ä½¿ç”¨ Token è°ƒç”¨ API

    ```bash
    curl -H "Authorization: token YOUR_TOKEN" \
      https://api.github.com/repos/OWNER/REPO
    ```

  - æ›¿ä»£: ä½¿ç”¨é»˜è®¤ `GITHUB_TOKEN` + `permissions: issues: write`

### Secrets è®¿é—®

- [ ] Fork PR è§¦å‘æ—¶æ— æ³•è®¿é—® secrets
  - æ¥æº: GitHub å®‰å…¨é™åˆ¶
  - æ›¿ä»£: ä½¿ç”¨ `pull_request_target` è§¦å‘å™¨

---

## ğŸ“¤ Safe-Outputs é…ç½®

### å†™æ“ä½œæ£€æŸ¥

- [ ] åˆ›å»º Issue éœ€å£°æ˜ `safe-outputs.create-issue`
- [ ] æ·»åŠ è¯„è®ºéœ€å£°æ˜ `safe-outputs.add-comment`
- [ ] åˆ›å»º PR éœ€å£°æ˜ `safe-outputs.create-pull-request`
- [ ] æ¯ç§å†™æ“ä½œéƒ½éœ€è¦å•ç‹¬å£°æ˜ï¼Œä¸ä¼šè‡ªåŠ¨ç»§æ‰¿

### å‚æ•°é…ç½®

- [ ] `title-prefix` ç”¨äºæ ‡è¯†è‡ªåŠ¨åˆ›å»ºçš„å†…å®¹
- [ ] `max` é™åˆ¶åˆ›å»ºæ•°é‡é˜²æ­¢å¤±æ§
- [ ] `labels` ç”¨äºåˆ†ç±»å’Œåç»­æ£€ç´¢
- [ ] `assignees: copilot` éœ€è¦é…ç½® `GH_AW_COPILOT_TOKEN` æˆ– `COPILOT_GITHUB_TOKEN` Secret
  - æ¥æº: [FC-002](FAILURE-CASES.md#fc-002-create-issue-assignees-copilot-é…ç½®ä¸ç”Ÿæ•ˆ)
  - éªŒè¯: `gh secret list | grep -i copilot`
  - æ›¿ä»£: ä½¿ç”¨ `create-agent-task` æ›¿ä»£ `create-issue` + `assignees: copilot`

### ä¸´æ—¶ ID æ”¯æŒ

- [ ] `assign-to-agent` ä¸æ”¯æŒä¸´æ—¶ IDï¼Œéœ€è¦çœŸå® Issue ç¼–å·
  - æ¥æº: [FC-001](FAILURE-CASES.md#fc-001-assign_to_agent-ä¸æ”¯æŒä¸´æ—¶-id)
  - æ›¿ä»£: ä½¿ç”¨äº‹ä»¶é©±åŠ¨åˆ†ç¦»æ¶æ„ï¼ˆè§ä¸‹æ–¹ï¼‰

- [ ] **åŒä¸€ workflow ä¸­ create-issue ä¸ assign æ“ä½œæ— æ³•é“¾å¼æ‰§è¡Œ**
  - æ¥æº: [FC-004](FAILURE-CASES.md#fc-004-create-issue-ä¸-assign-to-agent-æ— æ³•é“¾å¼æ‰§è¡Œ)
  - åŸå› : Agent åªèƒ½è·å¾—ä¸´æ—¶ IDï¼ŒçœŸå®ç¼–å·åœ¨ safe-output job æ‰§è¡Œåæ‰äº§ç”Ÿ
  - **è§£å†³æ–¹æ¡ˆ**: äº‹ä»¶é©±åŠ¨åˆ†ç¦»æ¶æ„
    1. Workflow A: åªè´Ÿè´£ `create-issue`ï¼Œé…ç½® `title-prefix: "[Plan] "`
    2. Workflow B: ç›‘å¬ `issues: opened` + æ ‡é¢˜åŒ¹é…ï¼Œæ‰§è¡Œ `assign-to-agent` å’Œ `assign-to-user`

---

## ğŸŒ ç½‘ç»œè®¿é—®

### æ²™ç®±é™åˆ¶

- [ ] é»˜è®¤æ²™ç®±æ¨¡å¼é™åˆ¶ç½‘ç»œè®¿é—®
- [ ] å¤–éƒ¨ API éœ€åŠ å…¥ `network.allowed` ç™½åå•
  - éªŒè¯: `network: { allowed: [api.example.com] }`
- [ ] ç¦ç”¨æ²™ç®±éœ€æ˜¾å¼å£°æ˜ `sandbox.agent: false`

### å¤–éƒ¨æœåŠ¡

- [ ] API ç«¯ç‚¹å¯è®¿é—®ï¼ˆéå†…ç½‘åœ°å€ï¼‰
- [ ] API æœ‰é€Ÿç‡é™åˆ¶æ—¶æ·»åŠ é‡è¯•é€»è¾‘
- [ ] è¶…æ—¶è®¾ç½®åˆç†ï¼ˆé»˜è®¤å¯èƒ½è¿‡çŸ­ï¼‰

---

## ğŸ”§ å·¥å…·ï¼ˆToolsï¼‰é…ç½®

### Bash å‘½ä»¤

- [ ] ä½¿ç”¨çš„å‘½ä»¤å·²å£°æ˜åœ¨ `tools.bash` ä¸­
- [ ] å±é™©å‘½ä»¤ï¼ˆå¦‚ `rm`ï¼‰éœ€è¦æ˜¾å¼å…è®¸
  - éªŒè¯: `bash: ["rm *"]` æˆ– `bash: [":*"]`

### æ–‡ä»¶æ“ä½œ

- [ ] å¯ç”¨ `tools.edit` æ‰èƒ½è¯»å†™æ–‡ä»¶
- [ ] æ–‡ä»¶è·¯å¾„ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºä»“åº“æ ¹ç›®å½•ï¼‰

### GitHub API

- [ ] å£°æ˜éœ€è¦çš„ toolsets
  - éªŒè¯: `github: { toolsets: [issues, pull_requests] }`

---

## â° å®šæ—¶ä»»åŠ¡ (Schedule)

- [ ] cron é—´éš” â‰¥ 5 åˆ†é’Ÿï¼ˆGitHub é™åˆ¶ï¼‰
- [ ] æ˜ç¡®æ—¶åŒºï¼ˆé»˜è®¤ UTCï¼‰
  - éªŒè¯: schedule è¡¨è¾¾å¼ä¸­çš„æ—¶é—´æ˜¯ UTC
- [ ] è€ƒè™‘æ—¶åŒºå·®å¼‚å¯¹ä¸šåŠ¡çš„å½±å“

---

## ğŸ”„ å¹‚ç­‰æ€§ä¸å¹¶å‘

- [ ] é‡å¤è§¦å‘ä¸ä¼šäº§ç”Ÿé‡å¤æ•°æ®
  - æ–¹æ³•: æ£€æŸ¥æ˜¯å¦å­˜åœ¨ â†’ åˆ›å»º
- [ ] å¹¶å‘æ‰§è¡Œæœ‰æ§åˆ¶
  - éªŒè¯: `concurrency` é…ç½®
- [ ] é•¿ä»»åŠ¡æœ‰è¶…æ—¶è®¾ç½®
  - éªŒè¯: `timeout-minutes`

---

## ğŸ“Š æ•°æ®å‡è®¾

- [ ] Issue/PR body å¯èƒ½ä¸ºç©º â†’ æ·»åŠ é»˜è®¤å€¼
- [ ] Labels å¯èƒ½ä¸å­˜åœ¨ â†’ å…ˆåˆ›å»ºæˆ–å®¹é”™
- [ ] ç”¨æˆ·è¾“å…¥å¯èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ â†’ è½¬ä¹‰å¤„ç†

---

## ğŸ§ª æµ‹è¯•éªŒè¯

- [ ] æœ¬åœ°ç¼–è¯‘é€šè¿‡: `gh aw compile`
- [ ] å°èŒƒå›´æµ‹è¯•åå†å¤§è§„æ¨¡è¿è¡Œ
- [ ] è§‚å¯Ÿç¬¬ä¸€æ¬¡è¿è¡Œçš„æ—¥å¿—

---

## æ›´æ–°è®°å½•

| æ—¥æœŸ | æ›´æ–°å†…å®¹ | å…³è”æ¡ˆä¾‹ |
|------|----------|----------|
| 2026-01-05 | æ·»åŠ  create-issue ä¸ assign é“¾å¼æ‰§è¡Œé™åˆ¶ | FC-004 |
| 2026-01-05 | æ·»åŠ  Fine-grained PAT æƒé™æ£€æŸ¥é¡¹ | FC-003 |
| 2026-01-04 | æ·»åŠ  assignees: copilot éœ€è¦ Token æ£€æŸ¥é¡¹ | FC-002 |
| 2026-01-04 | æ·»åŠ  assign-to-agent ä¸´æ—¶ ID é™åˆ¶æ£€æŸ¥é¡¹ | FC-001 |
| 2026-01-02 | åˆå§‹ç‰ˆæœ¬ï¼Œä»å®˜æ–¹æ–‡æ¡£å’Œå·²çŸ¥æœ€ä½³å®è·µæç‚¼ | - |
