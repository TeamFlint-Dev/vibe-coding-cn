# verseComponent èƒ½åŠ›è¾¹ç•Œæ–‡æ¡£

> **ç‰ˆæœ¬**: 1.0 | **æ›´æ–°æ—¥æœŸ**: 2026-01-06
>
> **ç›®æ ‡**: å¿«é€Ÿåˆ¤æ–­ç»„ä»¶å±‚ä»»åŠ¡æ˜¯å¦å¯è¡Œï¼Œé¿å…æ— æ•ˆè°ƒç ”

---

## èƒ½åŠ›é€ŸæŸ¥çŸ©é˜µ

### èƒ½åšçš„äº‹ï¼ˆç»¿ç¯åŒºï¼‰

| ç±»åˆ« | å…·ä½“èƒ½åŠ› | é€‚ç”¨åœºæ™¯ |
|------|----------|----------|
| è‡ªå®šä¹‰ç»„ä»¶ | ç»§æ‰¿ `component` åŸºç±»ï¼Œå®ç°ç”Ÿå‘½å‘¨æœŸé’©å­ | æ‰€æœ‰éœ€è¦è¿è¡Œæ—¶è¡Œä¸ºçš„æ¸¸æˆå¯¹è±¡ |
| çŠ¶æ€ç®¡ç† | æŒæœ‰ `var` å˜é‡ï¼Œé€šè¿‡ `set` æ›´æ–°çŠ¶æ€ | è¡€é‡ã€ä½ç½®ã€æ¿€æ´»çŠ¶æ€ç­‰è¿è¡Œæ—¶æ•°æ® |
| äº‹ä»¶å¤„ç† | å®ç° `OnReceive<override>()` æ¥æ”¶äº‹ä»¶ | ç»„ä»¶é—´é€šä¿¡ã€è·¨ Entity åä½œ |
| äº‹ä»¶å‘é€ | ä½¿ç”¨ `SendUp/SendDown/SendDirect` å‘é€äº‹ä»¶ | å­å‘çˆ¶æŠ¥å‘Šã€çˆ¶å‘å­å¹¿æ’­ã€ç‚¹å¯¹ç‚¹é€šä¿¡ |
| é…ç½®å±æ€§ | ä½¿ç”¨ `@editable` æ ‡è®°å¯åœ¨ç¼–è¾‘å™¨è°ƒæ•´çš„å‚æ•° | MaxHealthã€Speed ç­‰è®¾è®¡å‚æ•° |
| ç”Ÿå‘½å‘¨æœŸæ§åˆ¶ | `OnBeginSimulation`, `OnSimulate`, `OnEndSimulation` | åˆå§‹åŒ–ã€æ¯å¸§æ›´æ–°ã€æ¸…ç† |
| çœŸå®å¯¹è±¡ç»‘å®š | æŒæœ‰ `fort_character`, `prop` ç­‰å¼•ç”¨ | è¿æ¥ Component å˜é‡ä¸æ¸¸æˆç³»ç»Ÿ |
| çº¯è®¡ç®—å§”æ‰˜ | è°ƒç”¨ Helper å±‚å‡½æ•°è·å–è®¡ç®—ç»“æœ | ä¼¤å®³è®¡ç®—ã€è·¯å¾„æŸ¥æ‰¾ç­‰å¤æ‚é€»è¾‘ |
| API å°è£…è°ƒç”¨ | é€šè¿‡ Wrapper å±‚è®¿é—® UEFN API | åº”ç”¨ä¼¤å®³ã€åŒæ­¥è¡€é‡ã€æ’­æ”¾åŠ¨ç”» |

> **æ ¸å¿ƒèƒ½åŠ›**: Component å±‚æ˜¯**çŠ¶æ€ç®¡ç†å’Œäº‹ä»¶è°ƒåº¦çš„å”¯ä¸€å‡ºå£**

### ä¸èƒ½åšçš„äº‹ï¼ˆçº¢ç¯åŒºï¼‰

| ç±»åˆ« | é™åˆ¶è¯´æ˜ | æ›¿ä»£æ–¹æ¡ˆ |
|------|----------|----------|
| ç›´æ¥è°ƒç”¨ UEFN API | åº”é€šè¿‡ Wrapper å±‚å°è£… | ä½¿ç”¨ `CharacterWrapper.ApplyDamage()` |
| åŒ…å«å¤æ‚è®¡ç®— | åº”å§”æ‰˜ç»™ Helper å±‚ | è°ƒç”¨ `HealthCalculator.CalculateDamageResult()` |
| ç¡¬ç¼–ç æ•°å€¼ | å½±å“è®¾è®¡è°ƒæ•´ | ä½¿ç”¨ `@editable` é…ç½®å±æ€§ |
| ç›´æ¥å¼•ç”¨å…¶ä»– Component | å¯¼è‡´ç´§è€¦åˆ | é€šè¿‡äº‹ä»¶é€šä¿¡æˆ– `GetComponent<T>()` |
| åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ– | Verse è¯­æ³•ä¸æ”¯æŒ | åœ¨ `OnBeginSimulation` ä¸­åˆå§‹åŒ– |
| ä¿®æ”¹å…¶ä»– Component çš„çŠ¶æ€ | ç ´åå°è£…æ€§ | å‘é€äº‹ä»¶è¯·æ±‚ï¼Œç”±å¯¹æ–¹å¤„ç† |
| å­˜å‚¨å¤§é‡ä¸´æ—¶æ•°æ® | æ€§èƒ½é—®é¢˜ | ä½¿ç”¨å±€éƒ¨å˜é‡æˆ–ä¸“é—¨çš„ cache component |

### æœ‰æ¡ä»¶èƒ½åšçš„äº‹ï¼ˆé»„ç¯åŒºï¼‰

| ç±»åˆ« | æ¡ä»¶ | é…ç½®æ–¹å¼ |
|------|------|----------|
| è®¿é—®åŒ Entity å…¶ä»–ç»„ä»¶ | éœ€ç¡®ä¿ç»„ä»¶å­˜åœ¨ | `if (HC := GetComponent<health_component>()):` |
| ä½¿ç”¨åç¨‹ | æ–¹æ³•å£°æ˜ä¸º `<suspends>` | `OnBeginSimulation<override>()<suspends>:void` |
| æŒæœ‰å¯é€‰å¼•ç”¨ | ä½¿ç”¨ `?` ç±»å‹æ ‡è®° | `var BoundCharacter:?fort_character = false` |
| è·¨ Entity é€šä¿¡ | éœ€çŸ¥é“å¯¹æ–¹å¼•ç”¨ | é€šè¿‡çˆ¶ Entity ä¸­è½¬æˆ–ç›´æ¥æŒæœ‰å¼•ç”¨ |

---

## æŠ€æœ¯é™åˆ¶è¯¦è§£

### Verse è¯­è¨€é™åˆ¶

| é™åˆ¶é¡¹ | è¯´æ˜ | å½±å“èŒƒå›´ |
|--------|------|----------|
| æ— æ„é€ å‡½æ•° | ä¸èƒ½åœ¨ `class` å£°æ˜æ—¶åˆå§‹åŒ– | æ‰€æœ‰åˆå§‹åŒ–é€»è¾‘å¿…é¡»åœ¨ `OnBeginSimulation` |
| `var` éœ€è¦ `set` | ä¿®æ”¹å˜é‡å¿…é¡»ç”¨ `set` å…³é”®å­— | æ‰€æœ‰çŠ¶æ€æ›´æ–°æ“ä½œ |
| `<private>` æ— æ³•å¤–éƒ¨è®¿é—® | ç§æœ‰å˜é‡å®Œå…¨éšè— | éœ€æä¾›å…¬å¼€çš„ getter æ–¹æ³• |
| `?` ç±»å‹éœ€è¦è§£åŒ… | å¯é€‰ç±»å‹å¿…é¡»ç”¨ `?` è¯­æ³•æ£€æŸ¥ | æ‰€æœ‰å¯èƒ½ä¸ºç©ºçš„å¼•ç”¨ |
| åç¨‹éœ€è¦ `<suspends>` | å¼‚æ­¥æ–¹æ³•å¿…é¡»æ ‡è®° | ä½¿ç”¨ `Sleep`, `loop` çš„æ–¹æ³• |

### SceneGraph æ¡†æ¶é™åˆ¶

| é™åˆ¶é¡¹ | è¯´æ˜ | å½±å“èŒƒå›´ |
|--------|------|----------|
| äº‹ä»¶åªèƒ½å‘ä¸Š/å‘ä¸‹/ç›´æ¥ | æ— æ³•å¹¿æ’­åˆ°æ‰€æœ‰ Entity | éœ€è®¾è®¡ Entity å±‚çº§ç»“æ„ |
| ç»„ä»¶ä¸èƒ½ç‹¬ç«‹å­˜åœ¨ | å¿…é¡»é™„åŠ åˆ° Entity | éœ€å…ˆåˆ›å»º Entity |
| ç”Ÿå‘½å‘¨æœŸé¡ºåºå›ºå®š | æ— æ³•æ”¹å˜é’©å­è°ƒç”¨é¡ºåº | ä¾èµ–é¡ºåºéœ€åœ¨æ¶æ„è®¾è®¡æ—¶ç¡®å®š |
| `OnSimulate` æ¯å¸§è°ƒç”¨ | é«˜é¢‘æ‰§è¡Œï¼Œæ€§èƒ½æ•æ„Ÿ | é¿å…åœ¨å…¶ä¸­åšå¤æ‚è®¡ç®— |

### UEFN ç¼–è¾‘å™¨é™åˆ¶

| é™åˆ¶é¡¹ | è¯´æ˜ | å½±å“èŒƒå›´ |
|--------|------|----------|
| `@editable` ç±»å‹é™åˆ¶ | åªæ”¯æŒåŸºç¡€ç±»å‹å’Œéƒ¨åˆ†å†…ç½®ç±»å‹ | å¤æ‚é…ç½®éœ€æ‹†åˆ†ä¸ºå¤šä¸ªå‚æ•° |
| ç¼–è¾‘å™¨åˆ·æ–°å»¶è¿Ÿ | ä¿®æ”¹ Verse ä»£ç åéœ€é‡æ–°ç¼–è¯‘ | è°ƒè¯•å‘¨æœŸè¾ƒé•¿ |
| ç¼–è¯‘é”™è¯¯ä¸æ˜ç¡® | é”™è¯¯ä¿¡æ¯å¯èƒ½ä¸å‡†ç¡® | éœ€ä¾èµ–è¿œç¨‹ç¼–è¯‘éªŒè¯ |

---

## ä¾èµ–å…³ç³»

### å‰ç½®æŠ€èƒ½

- **å¿…éœ€**: [verseEventFlow](../verseEventFlow/SKILL.md) - ç†è§£äº‹ä»¶ç³»ç»Ÿ
- **å¿…éœ€**: [verseHelpers](../verseHelpers/SKILL.md) - ä½¿ç”¨ Helper å’Œ Wrapper å±‚
- **æ¨è**: [verseFrameworkDesigner](../verseFrameworkDesigner/SKILL.md) - æ¶æ„è®¾è®¡æŒ‡å¯¼

### ä¾èµ–èµ„æº

- **API æ–‡æ¡£**: `shared/api-digests/Verse.digest.verse`ï¼ˆSceneGraph APIï¼‰
- **ä»£ç åº“**: `shared/code-library/Components/` - å‚è€ƒå®ç°
- **æ¡†æ¶æŒ‡å—**: `shared/references/scenegraph-framework-guide.md`
- **æ¶æ„æ¨¡æ¿**: `shared/project-templates/@architecture-blueprint.md`

---

## åœºæ™¯å†³ç­–æ ‘

```text
éœ€è¦å®ç°æ¸¸æˆå¯¹è±¡è¡Œä¸ºï¼Ÿ
â”œâ”€â”€ ç®€å•çŠ¶æ€ï¼ˆå¦‚å¼€å…³ï¼‰â†’ âœ… ç›´æ¥ç”¨ component
â”œâ”€â”€ å¤æ‚é€»è¾‘ï¼ˆå¦‚AIï¼‰
â”‚   â”œâ”€â”€ éœ€è¦å¤šä¸ªç»„ä»¶åä½œï¼Ÿâ†’ âœ… è‡ªå®šä¹‰ entity ç±»
â”‚   â””â”€â”€ ç‹¬ç«‹åŠŸèƒ½ï¼Ÿâ†’ âœ… å•ä¸ª component + Helper
â””â”€â”€ çº¯æ•°æ®å®¹å™¨ â†’ âŒ ä½¿ç”¨ struct

éœ€è¦é€šä¿¡ï¼Ÿ
â”œâ”€â”€ å­å‘çˆ¶æŠ¥å‘Š â†’ âœ… SendUp(event)
â”œâ”€â”€ çˆ¶å‘å­å¹¿æ’­ â†’ âœ… SendDown(event)
â”œâ”€â”€ ç‚¹å¯¹ç‚¹ â†’ âœ… SendDirect(event)
â””â”€â”€ åŒ Entity ç»„ä»¶ â†’ ğŸŸ¡ GetComponent<T>()ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

éœ€è¦è®¡ç®—ï¼Ÿ
â”œâ”€â”€ ç®€å•ç®—æœ¯ â†’ âœ… Component å†…éƒ¨ç›´æ¥è®¡ç®—
â”œâ”€â”€ å¤æ‚å…¬å¼ï¼ˆå¦‚ä¼¤å®³ï¼‰â†’ âŒ å§”æ‰˜ç»™ Helper å±‚
â””â”€â”€ éœ€è¦è°ƒç”¨ UEFN API â†’ âŒ é€šè¿‡ Wrapper å±‚

éœ€è¦å­˜å‚¨çŠ¶æ€ï¼Ÿ
â”œâ”€â”€ è¿è¡Œæ—¶å˜åŒ– â†’ âœ… var CurrentHealth:int
â”œâ”€â”€ è®¾è®¡å‚æ•° â†’ âœ… @editable var MaxHealth:int
â”œâ”€â”€ ä¸´æ—¶è®¡ç®— â†’ âœ… å±€éƒ¨å˜é‡
â””â”€â”€ å¤§é‡ç¼“å­˜ â†’ âŒ åˆ›å»ºä¸“é—¨çš„ cache component
```

---

## å¸¸è§é—®é¢˜é€ŸæŸ¥

### Q: Component å¯ä»¥ç›´æ¥è°ƒç”¨ `fort_character.Damage()` å—ï¼Ÿ

**A**: âŒ ä¸æ¨èã€‚åº”è¯¥é€šè¿‡ Wrapper å±‚ï¼š

```verse
# âŒ ä¸æ¨è
if (Character := BoundCharacter?):
    Character.Damage(50.0)  # ç›´æ¥è°ƒç”¨ API

# âœ… æ¨è
CharacterWrapper.ApplyDamage(Character, 50.0)  # é€šè¿‡ Wrapper
```

**åŸå› **: Wrapper å±‚å¤„ç† API è¾¹ç•Œã€é”™è¯¯æ£€æŸ¥ã€å‚æ•°è½¬æ¢ã€‚

### Q: ä¸ºä»€ä¹ˆä¼¤å®³è®¡ç®—è¦æ”¾åœ¨ Helper è€Œä¸æ˜¯ Componentï¼Ÿ

**A**: å…³æ³¨ç‚¹åˆ†ç¦»ï¼š

- **Component**: ç®¡ç†çŠ¶æ€ï¼ˆ`CurrentHealth`ï¼‰ã€ç»‘å®šå¯¹è±¡ï¼ˆ`BoundCharacter`ï¼‰ã€å‘é€äº‹ä»¶
- **Helper**: çº¯å‡½æ•°è®¡ç®—ï¼ˆè¾“å…¥çŠ¶æ€ â†’ è¿”å›ç»“æœï¼‰ï¼Œå¯ç‹¬ç«‹æµ‹è¯•å’Œå¤ç”¨

```verse
# Component èŒè´£
OnReceiveDamage(Amount:int):void =
    Result := HealthCalculator.CalculateDamageResult(...)  # è°ƒç”¨ Helper
    set CurrentHealth = Result.NewHealth                    # æ›´æ–°çŠ¶æ€
    CharacterWrapper.ApplyDamage(...)                       # åŒæ­¥åˆ°æ¸¸æˆå¯¹è±¡
    DispatchHealthChanged()                                 # å‘é€äº‹ä»¶
```

### Q: å¦‚ä½•é¿å… Component é—´çš„ç´§è€¦åˆï¼Ÿ

**A**: ä¼˜å…ˆä½¿ç”¨äº‹ä»¶é€šä¿¡ï¼š

```verse
# âŒ ç´§è€¦åˆï¼šç›´æ¥å¼•ç”¨
attack_component := class(component):
    var TargetHealthComponent:health_component  # ç¡¬ä¾èµ–ï¼
    
    Attack():void =
        TargetHealthComponent.TakeDamage(10)

# âœ… æ¾è€¦åˆï¼šé€šè¿‡äº‹ä»¶
attack_component := class(component):
    OnAttackHit(Target:entity):void =
        if (Owner := GetOwner()):
            Owner.SendDirect(
                damage_event{Amount := 10}, 
                Target
            )
```

### Q: `@editable` å˜é‡å¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹å—ï¼Ÿ

**A**: âœ… å¯ä»¥ï¼Œä½†è¦åŒºåˆ†ä¸¤ç§ç”¨é€”ï¼š

- **è®¾è®¡å‚æ•°**: åœ¨ç¼–è¾‘å™¨ä¸­è°ƒæ•´ï¼Œè¿è¡Œæ—¶é€šå¸¸ä¸å˜ï¼ˆå¦‚ `MaxHealth := 100`ï¼‰
- **è¿è¡Œæ—¶çŠ¶æ€**: é¢‘ç¹å˜åŒ–ï¼Œä¸éœ€è¦ `@editable`ï¼ˆå¦‚ `var CurrentHealth:int`ï¼‰

```verse
@editable var MaxHealth:int = 100      # è®¾è®¡å‚æ•°ï¼ˆå¯åœ¨ç¼–è¾‘å™¨è°ƒæ•´ï¼‰
var CurrentHealth<private>:int = 0     # è¿è¡Œæ—¶çŠ¶æ€ï¼ˆä¸å¯ç¼–è¾‘å™¨è°ƒæ•´ï¼‰
```

### Q: å¦‚ä½•å¤„ç†å¯é€‰çš„æ¸¸æˆå¯¹è±¡å¼•ç”¨ï¼Ÿ

**A**: ä½¿ç”¨ `?` ç±»å‹å¹¶å§‹ç»ˆæ£€æŸ¥ï¼š

```verse
var BoundCharacter<private>:?fort_character = false

OnReceiveDamage(Amount:int):void =
    if (Character := BoundCharacter?):  # æ£€æŸ¥æ˜¯å¦ç»‘å®š
        CharacterWrapper.ApplyDamage(Character, Amount)
    else:
        # æœªç»‘å®šæ—¶çš„å¤„ç†é€»è¾‘
        Print("è­¦å‘Šï¼šç»„ä»¶æœªç»‘å®š Character")
```

---

## ç›¸å…³èµ„æº

- [ä¸»æŠ€èƒ½æ–‡æ¡£](SKILL.md)
- [å‰ç½®æ£€æŸ¥æ¸…å•](PREFLIGHT-CHECKLIST.md)
- [å¤±è´¥æ¡ˆä¾‹åº“](FAILURE-CASES.md)
- [å†³ç­–è®°å½•](DECISION-LOG.md)
- [verseHelpers/SKILL.md](../verseHelpers/SKILL.md) - Helper å’Œ Wrapper å±‚
- [verseEventFlow/SKILL.md](../verseEventFlow/SKILL.md) - äº‹ä»¶ç³»ç»Ÿ
