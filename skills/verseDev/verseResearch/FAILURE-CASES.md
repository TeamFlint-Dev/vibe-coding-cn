# verseResearch 失败案例库

> **用途**: 记录研究过程中的常见失败案例和陷阱，帮助避免重复踩坑  
> **更新机制**: 每次遇到失败案例时记录

---

## 📚 如何使用本文档

**使用场景**：

1. **研究启动前**：浏览失败案例，避免已知陷阱
2. **遇到困难时**：查找是否有类似失败案例和解决方案
3. **研究完成后**：记录新的失败经验

**记录格式**：

```markdown
## [案例编号] [简短标题]

**失败场景**: [描述失败的具体场景]
**失败原因**: [分析失败的根本原因]
**后果**: [失败导致的后果]
**正确做法**: [应该如何做]
**预防措施**: [如何提前避免]
**相关资源**: [相关文档链接]
```

---

## 🚨 高频失败案例（必读）

### FC-001: 研究范围过大导致无法完成

**失败场景**:

启动研究"SceneGraph 完整能力调研"，试图在一个研究中覆盖所有 SceneGraph 特性，包括 Entity、Component、Event、生命周期、性能等。

**失败原因**:

- 研究范围过于宽泛，涉及多个不相关的子主题
- 缺乏明确的边界和优先级
- 时间估算不足，实际需要数周而非数天

**后果**:

- 研究拖延数周未完成
- 产出的文档过于庞大，难以阅读和维护
- 部分结论未充分验证

**正确做法**:

```markdown
# 拆分为多个独立研究
- R00-SceneGraph-Entity-Component: Entity 和 Component 系统
- R01-SceneGraph-Event-System: 事件系统
- R02-SceneGraph-Lifecycle: 生命周期管理
- R03-SceneGraph-Performance: 性能特性
```

**预防措施**:

- [ ] 使用 PREFLIGHT-CHECKLIST.md 的"范围可控"检查项
- [ ] 单个研究聚焦一个核心问题
- [ ] 预计时间超过 5 天时，考虑拆分

**相关资源**:

- [PREFLIGHT-CHECKLIST.md](PREFLIGHT-CHECKLIST.md) - 阶段 5.2 范围检查

---

### FC-002: 缺乏验证导致错误结论

**失败场景**:

基于对 API 文档的理解，得出"Component 不支持多重继承"的结论，但未编写验证代码，后续项目中发现实际支持。

**失败原因**:

- 仅依赖文档推断，未实际验证
- 假设文档描述完整，忽略未文档化的行为
- 缺乏边界测试

**后果**:

- 错误结论影响架构设计
- 后续项目中需要返工
- 降低研究结论的可信度

**正确做法**:

```verse
// 编写最小化验证代码
component_base := class(entity_component):

component_a := class(component_base):

component_b := class(component_base):

# 测试：能否同时继承？
component_multi := class(component_a, component_b):
    # 验证多重继承行为
```

**预防措施**:

- [ ] 所有结论必须有对应的验证代码
- [ ] 验证代码必须通过远程编译
- [ ] 在 UEFN 编辑器中测试运行时行为

**相关资源**:

- [SKILL.md](SKILL.md) - 阶段 3: 假设与验证
- `tools/verseCompiler/` - 远程编译工具

---

### FC-003: 过度推测官方未文档化的功能

**失败场景**:

在 API Digest 中发现未公开的函数 `InternalOptimizeEntity()`，推测其用于性能优化，并建议在项目中使用。

**失败原因**:

- 依赖未文档化的内部 API
- 未验证 API 的稳定性和副作用
- 假设内部 API 在未来版本中不会变化

**后果**:

- 内部 API 在后续版本中被移除
- 项目代码出现编译错误
- 需要紧急重构

**正确做法**:

```markdown
# 标注为"未文档化，不建议使用"
## 发现：InternalOptimizeEntity()

**状态**: ⚠️ 未文档化的内部 API
**建议**: 不建议在生产项目中使用
**原因**: 
- 未出现在官方文档
- 可能在未来版本中移除或变更
- 无官方支持

**替代方案**: 使用已文档化的优化方法
```

**预防措施**:

- [ ] 明确区分"已文档化 API"和"未文档化 API"
- [ ] 未文档化 API 标注风险警告
- [ ] 优先使用官方文档中的 API

**相关资源**:

- [CAPABILITY-BOUNDARIES.md](CAPABILITY-BOUNDARIES.md) - 研究边界

---

### FC-004: 忽略性能测试导致错误建议

**失败场景**:

研究"Component 数据存储方案"，得出"使用 Map 存储游戏数据"的结论，但未测试大规模数据下的性能。

**失败原因**:

- 仅验证功能正确性，未测试性能
- 假设小规模测试的性能表现可以线性扩展
- 未测试边界情况（1000+ 实体）

**后果**:

- 项目中使用 Map 存储 1000+ 玩家数据
- 出现严重的性能瓶颈
- 需要重新设计数据结构

**正确做法**:

```markdown
## 性能测试

### 测试场景
- 小规模: 10 个实体
- 中等规模: 100 个实体
- 大规模: 1000 个实体
- 极限规模: 5000 个实体

### 测试指标
- 插入性能
- 查询性能
- 内存占用
- GC 压力

### 测试结果
| 实体数 | 插入时间 | 查询时间 | 内存 |
|--------|---------|---------|------|
| 10     | 0.1ms   | 0.05ms  | 1KB  |
| 100    | 1.2ms   | 0.5ms   | 12KB |
| 1000   | 45ms    | 15ms    | 150KB |
| 5000   | 500ms ⚠️ | 200ms ⚠️ | 1.2MB |

### 结论
Map 适用于 < 1000 实体的场景，超过后性能下降明显。
```

**预防措施**:

- [ ] 涉及数据结构/算法的研究，必须包含性能测试
- [ ] 测试多个数量级（10, 100, 1000, 5000）
- [ ] 明确标注性能建议的适用范围

**相关资源**:

- [SKILL.md](SKILL.md) - 验证原则

---

## ⚠️ 中频失败案例

### FC-005: 研究成果散落各处

**失败场景**:

研究过程中，笔记记录在多个位置：

- 部分笔记在 `verseResearch/reports/`
- 验证代码在临时测试项目中
- 结论散落在 Issue 评论里

**失败原因**:

- 缺乏统一的文档组织规范
- 研究过程中随意记录
- 未及时整理成正式报告

**后果**:

- 研究结论难以查找
- 验证代码丢失
- 后续研究无法参考前人工作

**正确做法**:

```markdown
# 统一存放结构
projects/uefnResearch/
├── architecture/
│   └── R03-Data-Structures/
│       ├── README.md              # 研究报告
│       ├── performance-test.md    # 性能测试结果
│       └── conclusion.md          # 结论摘要
└── progress/
    └── R03-notes.md               # 研究笔记
    
verse/library/
└── test-data-structures.verse     # 验证代码
```

**预防措施**:

- [ ] 使用 PREFLIGHT-CHECKLIST.md 规划输出位置
- [ ] 研究启动时创建目录结构
- [ ] 研究完成后整理所有产物

**相关资源**:

- [PREFLIGHT-CHECKLIST.md](PREFLIGHT-CHECKLIST.md) - 阶段 6: 输出规划

---

### FC-006: 忽略官方文档的更新

**失败场景**:

基于 UEFN 版本 38.00 的 API 进行研究，得出结论，但未注意到版本 39.00 中相关 API 已更新。

**失败原因**:

- 未检查 API Digest 的版本
- 未查阅 Changelog
- 假设 API 不会变化

**后果**:

- 研究结论基于过时的 API
- 后续项目使用新版本时无法应用
- 需要重新研究

**正确做法**:

```markdown
## API 版本信息

**Digest 版本**: `++Fortnite+Release-39.11-CL-49242330`
**研究日期**: 2026-01-06
**相关 API**:
- `Verse.SceneGraph.Entity` (v39.11)
- `Fortnite.Devices.CreativeDevice` (v39.11)

**版本变更检查**:
- [x] 查阅 Changelog
- [x] 对比上一版本差异
- [x] 标注 Breaking Changes
```

**预防措施**:

- [ ] 研究开始前检查 API Digest 版本
- [ ] 研究报告中标注 API 版本
- [ ] 定期使用 verseDigestSync 更新 API

**相关资源**:

- `skills/verseDev/shared/api-digests/` - API Digest 文件
- [verseDigestSync](../verseDigestSync/SKILL.md) - API 同步工具

---

### FC-007: 未标注研究的局限性

**失败场景**:

研究"Component 生命周期"，得出结论，但未标注以下局限性：

- 仅测试了单一场景
- 未测试嵌套 Entity
- 未测试多人游戏环境

**失败原因**:

- 假设测试覆盖了所有场景
- 未明确标注测试范围
- 过度推广结论

**后果**:

- 他人在不同场景下应用结论时失败
- 降低研究的可信度
- 需要补充测试

**正确做法**:

```markdown
## 研究局限性

### 测试范围
- ✅ 单一 Entity 的生命周期
- ✅ 基本 Component 的添加/移除
- ❌ 未测试：嵌套 Entity
- ❌ 未测试：多人游戏环境
- ❌ 未测试：动态 Component 替换

### 适用场景
本研究结论适用于：
- 单人游戏或 Host 端逻辑
- 简单的 Entity 层级结构
- 静态 Component 配置

### 不适用场景
本研究结论不适用于：
- Client 端的生命周期行为（未测试）
- 复杂的嵌套 Entity（未测试）
- 高频 Component 动态替换（未测试）
```

**预防措施**:

- [ ] 研究报告必须包含"局限性"章节
- [ ] 明确标注"已测试"和"未测试"
- [ ] 不过度推广结论到未测试场景

**相关资源**:

- [SKILL.md](SKILL.md) - 文档输出标准

---

## 💡 低频但高影响失败案例

### FC-008: 研究方向被需求牵引

**失败场景**:

研究"SceneGraph 事件系统"过程中，项目突然需要实现一个特定功能，研究方向被牵引到解决该功能，最终变成"如何实现 XX 功能"。

**失败原因**:

- 研究目标不明确
- 未区分"研究"和"开发"
- 被短期需求打断

**后果**:

- 研究变成开发任务
- 原定研究目标未完成
- 研究深度不足

**正确做法**:

```markdown
# 区分研究和开发

## 研究（verseResearch + uefnResearch）
目标：理解事件系统的边界和原理
- 事件传播机制
- 事件优先级
- 性能特性

## 开发（verseComponent + verseHelpers）
目标：实现具体功能
- 实现商店系统
- 实现对话系统

如果研究过程中发现需要开发，应：
1. 记录开发需求到项目文档
2. 继续完成研究
3. 研究完成后再进行开发
```

**预防措施**:

- [ ] 研究启动时明确目标（SMART 原则）
- [ ] 遇到开发需求时记录，不立即执行
- [ ] 研究完成后再处理开发任务

**相关资源**:

- [CAPABILITY-BOUNDARIES.md](CAPABILITY-BOUNDARIES.md) - verseResearch 不执行开发

---

## 📝 如何添加新的失败案例

当遇到新的失败经验时，请按以下格式记录：

```markdown
## FC-[下一个编号] [简短标题]

**失败场景**: 
[详细描述失败的具体场景，包括背景、过程、结果]

**失败原因**: 
[分析失败的根本原因，而非表面现象]

**后果**: 
[失败导致的后果，如时间浪费、错误结论、返工等]

**正确做法**: 
[应该如何做，提供具体的步骤或代码示例]

**预防措施**: 
- [ ] 检查项 1
- [ ] 检查项 2
- [ ] 检查项 3

**相关资源**: 
- [相关文档链接]
```

---

## 🔗 相关文档

- [SKILL.md](SKILL.md) - 研究方法论
- [CAPABILITY-BOUNDARIES.md](CAPABILITY-BOUNDARIES.md) - 能力边界
- [PREFLIGHT-CHECKLIST.md](PREFLIGHT-CHECKLIST.md) - 前置检查清单
- [projects/uefnResearch/](../../../projects/uefnResearch/) - 研究项目

---

## 📊 失败案例统计

| 类别 | 案例数 | 最新更新 |
|------|--------|----------|
| 高频失败 | 4 | 2026-01-06 |
| 中频失败 | 3 | 2026-01-06 |
| 低频高影响 | 1 | 2026-01-06 |
| **总计** | **8** | **2026-01-06** |

---

*最后更新: 2026-01-06*  
*文档版本: 2.0.0*
