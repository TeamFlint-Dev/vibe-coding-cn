# issue-triage-agent å·¥ä½œæµåˆ†ææŠ¥å‘Š

> **åˆ†ææ—¥æœŸ**: 2026-01-10  
> **è¿è¡Œç¼–å·**: #4  
> **åˆ†æè€…**: workflow-case-study Agent

---

## ğŸ“Œ æ ¸å¿ƒå‘ç°

1. **å¯¹æ¯”åˆ†ææ­ç¤ºä¸¤ç§ Issue åˆ†ç±»ç­–ç•¥**ï¼š`issue-triage-agent`ï¼ˆä¸»åŠ¨å¼æ‰¹å¤„ç†ï¼‰ä¸ `issue-classifier`ï¼ˆè¢«åŠ¨å¼äº‹ä»¶é©±åŠ¨ï¼‰è§£å†³åŒä¸€é—®é¢˜ï¼Œä½†è®¾è®¡å“²å­¦æˆªç„¶ä¸åŒã€‚
2. **Label-Constrained Safe-Output æ¨¡å¼**ï¼š`safe-outputs.add-labels.allowed` é…ç½®ç™½åå•æœºåˆ¶ï¼Œæ˜¯å®‰å…¨è¾“å‡ºçš„ç»†ç²’åº¦æ§åˆ¶åˆ›æ–°ã€‚
3. **Schedule è§¦å‘å™¨ + æ‰¹å¤„ç† = ä½è´Ÿè½½é«˜åå**ï¼šä¸»åŠ¨æ‰«ææ— æ ‡ç­¾ Issue è€Œéé€ä¸ªå“åº”äº‹ä»¶ï¼Œå‡å°‘å·¥ä½œæµè¿è¡Œæ¬¡æ•°ã€‚
4. **ç”¨æˆ·å‹å¥½æ³¨é‡Š**ï¼šæ·»åŠ æ ‡ç­¾å @mention ä½œè€…å¹¶è§£é‡Šç†ç”±ï¼Œæå‡é€æ˜åº¦å’Œç”¨æˆ·ä¿¡ä»»ã€‚

---

## ğŸ¯ ç ”ç©¶åŠ¨æœº

**é€‰æ‹©ç†ç”±**: 
- ä¸ç ”ç©¶è®®ç¨‹ P1ã€ŒAgent åä½œæ¨¡å¼ã€ç›¸å…³ï¼štriage agent å±•ç¤ºäº†å• Agent è‡ªåŠ¨åŒ–æ¨¡å¼
- æœªåœ¨å·²åˆ†æå·¥ä½œæµåˆ—è¡¨ä¸­
- å®ç”¨æ€§é«˜ï¼šIssue åˆ†ç±»æ˜¯å¸¸è§éœ€æ±‚ï¼Œå¯ç›´æ¥å¤ç”¨

**ç ”ç©¶é—®é¢˜**:
- å®˜æ–¹å¦‚ä½•è®¾è®¡ Issue è‡ªåŠ¨åˆ†ç±»ï¼Ÿ
- ä¸å·²æœ‰çš„ `issue-classifier` æœ‰ä½•ä¸åŒï¼Ÿ
- æœ‰å“ªäº›å¯å¤ç”¨çš„æ¨¡å¼æˆ–æŠ€å·§ï¼Ÿ

---

## ğŸ“Š åˆ†ææ‘˜è¦

### issue-triage-agent

| ç»´åº¦ | é…ç½® | è¯„ä¼° |
|------|------|------|
| è§¦å‘æ–¹å¼ | `schedule: "0 14 * * 1-5"` + `workflow_dispatch` | â­â­ å·¥ä½œæ—¥å®šæ—¶ + æ‰‹åŠ¨è§¦å‘ï¼Œä½†æœªä½¿ç”¨ fuzzy scheduling |
| æƒé™è®¾è®¡ | `issues: read` | â­â­â­ æœ€å°åªè¯»æƒé™ï¼Œå†™æ“ä½œé€šè¿‡ safe-outputs |
| å·¥å…·ç»„åˆ | `github.toolsets: [issues, labels]` | â­â­â­ ç²¾ç¡®å£°æ˜æ‰€éœ€å·¥å…·é›† |
| è¶…æ—¶è®¾ç½® | `timeout-minutes: 5` | â­â­â­ æ‰¹å¤„ç†ä»»åŠ¡åˆç†çŸ­è¶…æ—¶ |
| å®‰å…¨è¾“å‡º | `add-labels.allowed: [...]` + `add-comment` | â­â­â­ ç™½åå•é™åˆ¶æ ‡ç­¾èŒƒå›´ |

### issue-classifierï¼ˆå¯¹æ¯”å‚ç…§ï¼‰

| ç»´åº¦ | é…ç½® | è¯„ä¼° |
|------|------|------|
| è§¦å‘æ–¹å¼ | `on: issues: types: [opened]` + `reaction: "eyes"` | â­â­â­ äº‹ä»¶é©±åŠ¨ + ååº”è§¦å‘åŒæ¨¡å¼ |
| æƒé™è®¾è®¡ | `contents: read`, `issues: read`, `pull-requests: read` | â­â­ æƒé™ç•¥å¤š |
| å·¥å…·ç»„åˆ | æ— æ˜¾å¼å£°æ˜ï¼ˆä¾èµ– importsï¼‰ | â­â­ ä¾èµ–å…±äº«é…ç½® |
| è¶…æ—¶è®¾ç½® | `timeout-minutes: 5` | â­â­â­ ç›¸åŒ |
| å®‰å…¨è¾“å‡º | `add-labels.allowed: [...], max: 1` | â­â­â­ æœ‰ max é™åˆ¶ |

---

## ğŸ¨ è¯†åˆ«çš„è®¾è®¡æ¨¡å¼

### å·²çŸ¥æ¨¡å¼

| æ¨¡å¼åç§° | åº”ç”¨æ–¹å¼ | ç‰¹åˆ«ä¹‹å¤„ |
|---------|---------|---------|
| Scheduled Pattern | å·¥ä½œæ—¥ 14:00 è§¦å‘ | ç²¾ç¡® cron è€Œé fuzzy |
| Safe-Output Pattern | `add-labels` + `add-comment` | é…åˆ `allowed` ç™½åå• |
| Event-Driven Patternï¼ˆissue-classifierï¼‰ | `on: issues: [opened]` | å³æ—¶å“åº” |
| Dual-Mode Triggerï¼ˆissue-classifierï¼‰ | `issues` + `reaction` | äº‹ä»¶ + ååº”åŒè§¦å‘ |

### ğŸ†• æ–°å‘ç°æ¨¡å¼

#### Label Whitelist Pattern

- **è¯†åˆ«ç‰¹å¾**: `safe-outputs.add-labels.allowed: [label1, label2, ...]`
- **è®¾è®¡æ„å›¾**: é™åˆ¶ Agent åªèƒ½æ·»åŠ é¢„å®šä¹‰çš„æ ‡ç­¾ï¼Œé˜²æ­¢åˆ›å»ºä»»æ„æ ‡ç­¾æˆ–æ·»åŠ æ•æ„Ÿæ ‡ç­¾
- **é…ç½®ç¤ºä¾‹**:
  ```yaml
  safe-outputs:
    add-labels:
      allowed: [bug, feature, enhancement, documentation, question, help-wanted, good-first-issue]
  ```
- **å®‰å…¨ä»·å€¼**: æ¯”å•çº¯çš„ `max` é™åˆ¶æ›´ç²¾ç»†ï¼Œæ§åˆ¶ã€Œèƒ½åšä»€ä¹ˆã€è€Œéåªæ§åˆ¶ã€Œåšå¤šå°‘æ¬¡ã€
- **å¯å¤ç”¨ä»·å€¼**: â­â­â­ ä»»ä½•éœ€è¦é™åˆ¶æ ‡ç­¾èŒƒå›´çš„åœºæ™¯

#### Batch-vs-Event Strategy Pattern

- **è¯†åˆ«ç‰¹å¾**: åŒä¸€é—®é¢˜åŸŸå­˜åœ¨ä¸¤ç§å®ç°â€”â€”å®šæ—¶æ‰¹å¤„ç† vs äº‹ä»¶å³æ—¶å“åº”
- **è®¾è®¡æ„å›¾**: 
  - **æ‰¹å¤„ç†ç­–ç•¥**ï¼ˆissue-triage-agentï¼‰ï¼šä½å·¥ä½œæµè¿è¡Œæ¬¡æ•°ã€ç»Ÿä¸€å¤„ç†é€»è¾‘ã€é€‚åˆå­˜é‡æ¸…ç†
  - **äº‹ä»¶ç­–ç•¥**ï¼ˆissue-classifierï¼‰ï¼šå³æ—¶å“åº”ã€ä½å»¶è¿Ÿã€é€‚åˆå¢é‡å¤„ç†
- **æƒè¡¡è€ƒé‡**:

  | ç»´åº¦ | æ‰¹å¤„ç† | äº‹ä»¶é©±åŠ¨ |
  |------|--------|---------|
  | å»¶è¿Ÿ | é«˜ï¼ˆç­‰å¾…ä¸‹æ¬¡è°ƒåº¦ï¼‰ | ä½ï¼ˆç§’çº§ï¼‰ |
  | è¿è¡Œæ¬¡æ•° | å°‘ï¼ˆæ¯å¤©ä¸€æ¬¡ï¼‰ | å¤šï¼ˆæ¯ä¸ªäº‹ä»¶ä¸€æ¬¡ï¼‰ |
  | æˆæœ¬ | ä½ | é«˜ï¼ˆå¦‚æœ Issue é‡å¤§ï¼‰ |
  | å­˜é‡å¤„ç† | âœ… æ”¯æŒ | âŒ ä»…å¢é‡ |
  
- **å¯å¤ç”¨ä»·å€¼**: â­â­â­ è®¾è®¡è‡ªåŠ¨åŒ–å·¥ä½œæµæ—¶çš„æ¶æ„å†³ç­–æŒ‡å¯¼

#### Author Notification Pattern

- **è¯†åˆ«ç‰¹å¾**: æ·»åŠ æ ‡ç­¾å `@mention` ä½œè€…å¹¶è§£é‡Šç†ç”±
- **è®¾è®¡æ„å›¾**: é€æ˜åŒ–è‡ªåŠ¨å†³ç­–ã€å‡å°‘ç”¨æˆ·å›°æƒ‘ã€å»ºç«‹ä¿¡ä»»
- **Prompt ç‰‡æ®µ**: "After adding the label to an issue, mention the issue author in a comment explaining why the label was added."
- **UX ä»·å€¼**: Agent ä¸æ˜¯é»‘ç›’â€”â€”ç”¨æˆ·çŸ¥é“ä¸ºä»€ä¹ˆè¢«åˆ†ç±»
- **å¯å¤ç”¨ä»·å€¼**: â­â­â­ ä»»ä½•è‡ªåŠ¨åŒ–å†³ç­–éƒ½åº”è§£é‡Šç†ç”±

---

## ğŸ’» å¯å¤ç”¨ç‰‡æ®µ

### ç‰‡æ®µ 1: Label Whitelist é…ç½®

```yaml
# ç”¨é€”: é™åˆ¶å¯æ·»åŠ çš„æ ‡ç­¾èŒƒå›´
safe-outputs:
  add-labels:
    allowed: [bug, feature, enhancement, documentation, question, help-wanted, good-first-issue]
  add-comment: {}
```

### ç‰‡æ®µ 2: GitHub Issues + Labels å·¥å…·é›†

```yaml
# ç”¨é€”: ç²¾ç¡®å£°æ˜ Issue ç®¡ç†æ‰€éœ€çš„ GitHub å·¥å…·
permissions:
  issues: read
tools:
  github:
    toolsets: [issues, labels]
```

### ç‰‡æ®µ 3: å·¥ä½œæ—¥å®šæ—¶è§¦å‘

```yaml
# ç”¨é€”: åªåœ¨å·¥ä½œæ—¥è¿è¡Œçš„å®šæ—¶ä»»åŠ¡
on:
  schedule: "0 14 * * 1-5"  # å‘¨ä¸€åˆ°å‘¨äº” 14:00 UTC
  workflow_dispatch:        # ä¿ç•™æ‰‹åŠ¨è§¦å‘èƒ½åŠ›
```

---

## ğŸ¤” æ‰¹åˆ¤æ€§åˆ†æ

### è®¾è®¡äº®ç‚¹

1. **æœ€å°æƒé™ + Safe-Output åŒä¿é™©**ï¼šåªè¯»æƒé™ + ç™½åå•æ ‡ç­¾ = å®‰å…¨è¾¹ç•Œæ¸…æ™°
2. **è·³è¿‡é€»è¾‘æ¸…æ™°**ï¼šã€Œå·²æœ‰æ ‡ç­¾ã€å’Œã€Œå·²åˆ†é…äººå‘˜ã€ä¸¤ä¸ªæ’é™¤æ¡ä»¶ï¼Œé¿å…å¹²æ‰°äººå·¥å·¥ä½œ
3. **ç”¨æˆ·å¯¼å‘**ï¼šè¯„è®ºè§£é‡Šç†ç”±ï¼Œä¸æ˜¯å†·å†°å†°çš„è‡ªåŠ¨åŒ–
4. **ç®€æ´é«˜æ•ˆ**ï¼šæ•´ä¸ª Prompt åªæœ‰ ~100 è¯ï¼Œå•ä¸€èŒè´£æ¸…æ™°

### æ”¹è¿›å»ºè®®

1. **è€ƒè™‘ Fuzzy Scheduling**ï¼š`schedule: "0 14 * * 1-5"` å¯èƒ½å¯¼è‡´å¤šä»“åº“åŒæ—¶è§¦å‘ï¼Œå»ºè®®æ”¹ä¸º `schedule: workdays` è®©ç¼–è¯‘å™¨è‡ªåŠ¨æ•£åˆ—
2. **ç¼ºå°‘ `max` é™åˆ¶**ï¼š`add-labels` æ²¡æœ‰ `max`ï¼Œå¦‚æœä»“åº“æœ‰å¤§é‡æ— æ ‡ç­¾ Issue å¯èƒ½è¶…è´Ÿè·
3. **ç¼ºå°‘ `strict` æ¨¡å¼**ï¼šå¯¹æ¯” `issue-classifier` æœ‰ `strict: true`ï¼Œå»ºè®®æ·»åŠ ä»¥å¢å¼ºå®‰å…¨æ€§
4. **æ—  `imports`**ï¼šå¯è€ƒè™‘å¼•å…¥ `shared/actions-ai-inference.md` ç­‰å…±äº«é…ç½®æå‡ä¸€è‡´æ€§

---

## ğŸ”— çŒœæƒ³å…³è”

### H003 (patterns/ ç›®å½•) - é—´æ¥ç›¸å…³

- è¯¥å·¥ä½œæµæœ¬èº«æ²¡æœ‰ä½¿ç”¨ `patterns/` æˆ– `repo-memory`
- ä½†å…¶è®¾è®¡å±•ç¤ºäº†ã€Œæ¨¡å¼åŒ–åˆ†ç±»ã€çš„ä»·å€¼â€”â€”7 ä¸ªé¢„å®šä¹‰æ ‡ç­¾å°±æ˜¯ä¸€ç§ç®€åŒ–çš„æ¨¡å¼åº“
- **å¯å‘**ï¼šå¤æ‚åˆ†ç±»ç³»ç»Ÿå¯èƒ½éœ€è¦å¤–éƒ¨æ¨¡å¼åº“æ”¯æŒ

### æ–°çŒœæƒ³ H005 (æè®®)

**çŒœæƒ³**: ã€Œè§£é‡Šæ€§è¯„è®ºã€ï¼ˆAuthor Notification Patternï¼‰æ˜¯æå‡ç”¨æˆ·å¯¹ AI è‡ªåŠ¨åŒ–ä¿¡ä»»åº¦çš„å…³é”®è®¾è®¡

- **ç†ç”±**: issue-triage-agent æ˜ç¡®è¦æ±‚ã€Œè§£é‡Šä¸ºä»€ä¹ˆæ·»åŠ è¯¥æ ‡ç­¾ã€
- **å¯éªŒè¯æ€§**: å¯¹æ¯”æœ‰/æ— è§£é‡Šçš„å·¥ä½œæµï¼Œè§‚å¯Ÿç”¨æˆ·åé¦ˆ
- **åˆå§‹çŠ¶æ€**: `proposed`

---

## ğŸ“ Skill æ›´æ–°å»ºè®®

- [x] workflowAnalyzer/patterns/BASIC.md: æ·»åŠ æ–°æ¨¡å¼ "Label Whitelist Pattern"
- [ ] workflowAnalyzer/patterns/BASIC.md: æ·»åŠ æ–°æ¨¡å¼ "Author Notification Pattern"  
- [ ] workflowAnalyzer/patterns/COORDINATION.md: è€ƒè™‘æ·»åŠ  "Batch-vs-Event Strategy Pattern"
- [ ] çŒœæƒ³åº“: æ·»åŠ  H005 (è§£é‡Šæ€§è¯„è®º)

---

## ğŸ”® åç»­ç ”ç©¶æ–¹å‘

1. **å¯¹æ¯”ç ”ç©¶**: åˆ†ææ›´å¤šã€ŒåŒä¸€é—®é¢˜åŸŸä¸åŒç­–ç•¥ã€çš„å·¥ä½œæµå¯¹ï¼Œæ€»ç»“æ¶æ„å†³ç­–æ¨¡å¼
2. **æ•ˆæœéªŒè¯**: ã€Œè§£é‡Šæ€§è¯„è®ºã€æ˜¯å¦çœŸçš„æå‡ç”¨æˆ·ä¿¡ä»»ï¼Ÿéœ€è¦å®é™…ç”¨æˆ·åé¦ˆæ•°æ®
3. **æˆæœ¬åˆ†æ**: æ‰¹å¤„ç† vs äº‹ä»¶é©±åŠ¨çš„å®é™…æˆæœ¬å·®å¼‚é‡åŒ–
4. **æ¨¡å¼æ¼”åŒ–**: `issue-classifier` ä½¿ç”¨äº† `imports` å’Œ `reaction` è§¦å‘ï¼Œæ˜¯å¦ä»£è¡¨æ›´æˆç†Ÿçš„è®¾è®¡ï¼Ÿ

---

## ğŸ“š å‚è€ƒèµ„æ–™

- æºæ–‡ä»¶: `githubnext/gh-aw/.github/workflows/issue-triage-agent.md`
- å¯¹æ¯”æ–‡ä»¶: `githubnext/gh-aw/.github/workflows/issue-classifier.md`
- å…±äº«é…ç½®: `githubnext/gh-aw/.github/workflows/shared/actions-ai-inference.md`
