# ğŸ£ é’“é±¼ç³»ç»Ÿ - æœºåˆ¶è®¾è®¡

> **ç³»ç»Ÿ**ï¼šFishing System  
> **ç‰ˆæœ¬**ï¼šv1.0  
> **å‰ç½®ä¾èµ–**ï¼š`@systems-breakdown.md`  
> **ç”Ÿæˆè€…**ï¼šgame-mechanics-designer

---

## ä¸€ã€ç³»ç»Ÿæ¦‚è¿°

**æ ¸å¿ƒèŒè´£**ï¼šæä¾›ç©å®¶ä¸»åŠ¨é‡‡é›†çš„å…¥å£ï¼Œé€šè¿‡é’“é±¼æµç¨‹äº§å‡ºæˆ˜åˆ©å“ã€‚

**è®¾è®¡ç›®æ ‡**ï¼š
- ç®€å•ç›´è§‚ï¼Œ5 ç§’å†…ç†è§£ç©æ³•
- æ¯æ¬¡é’“é±¼ 10-30 ç§’ï¼Œä¿æŒè½»é‡
- æœ‰è¶³å¤Ÿçš„éšæœºæ€§ç»´æŒæƒŠå–œæ„Ÿ

---

## äºŒã€çŠ¶æ€æœºè®¾è®¡

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                      â”‚
                    â–¼                                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
              â”‚   IDLE   â”‚ â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚     â”‚
                    â”‚                                â”‚     â”‚
                    â”‚ [ç©å®¶äº¤äº’é’“ç‚¹]                   â”‚     â”‚
                    â–¼                                â”‚     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚     â”‚
              â”‚ CASTING  â”‚ æŠ•ç«¿åŠ¨ç”» (0.5s)            â”‚     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚     â”‚
                    â”‚                                â”‚     â”‚
                    â”‚ [åŠ¨ç”»å®Œæˆ]                      â”‚     â”‚
                    â–¼                                â”‚     â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚     â”‚
              â”‚ WAITING  â”‚ ç­‰å¾…å’¬é’© (3-15s)          â”‚     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚     â”‚
                    â”‚                                â”‚     â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚     â”‚
          â”‚                 â”‚                        â”‚     â”‚
    [è¶…æ—¶æœªå’¬é’©]        [å’¬é’©è§¦å‘]                    â”‚     â”‚
          â”‚                 â”‚                        â”‚     â”‚
          â–¼                 â–¼                        â”‚     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚     â”‚
    â”‚  MISSED  â”‚      â”‚  HOOKED  â”‚ å’¬é’©çª—å£ (2s)     â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚     â”‚
          â”‚                 â”‚                        â”‚     â”‚
          â”‚           â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                  â”‚     â”‚
          â”‚           â”‚           â”‚                  â”‚     â”‚
          â”‚     [åŠæ—¶æ”¶æ†]   [è¶…æ—¶æœªæ”¶]               â”‚     â”‚
          â”‚           â”‚           â”‚                  â”‚     â”‚
          â”‚           â–¼           â–¼                  â”‚     â”‚
          â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚     â”‚
          â”‚     â”‚ SUCCESS  â”‚ â”‚  FAILED  â”‚            â”‚     â”‚
          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚     â”‚
          â”‚           â”‚           â”‚                  â”‚     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                                                           â”‚
                      [3s åè‡ªåŠ¨é‡ç½®] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€çŠ¶æ€è¯¦è§£

### 3.1 IDLEï¼ˆç©ºé—²ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| å…¥å£æ¡ä»¶ | åˆå§‹çŠ¶æ€ / é’“é±¼ç»“æŸå |
| ç©å®¶è¡Œä¸º | å¯è‡ªç”±ç§»åŠ¨ï¼Œé è¿‘é’“ç‚¹æ—¶æ˜¾ç¤ºäº¤äº’æç¤º |
| é€€å‡ºæ¡ä»¶ | ç©å®¶æŒ‰ä¸‹äº¤äº’é”® |
| UI æç¤º | é’“ç‚¹ä¸Šæ–¹æ˜¾ç¤ºã€ŒæŒ‰ [E] å¼€å§‹é’“é±¼ã€ |

---

### 3.2 CASTINGï¼ˆæŠ•ç«¿ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| æŒç»­æ—¶é—´ | 0.5 ç§’ |
| ç©å®¶è¡Œä¸º | é”å®šç§»åŠ¨ï¼Œæ’­æ”¾æŠ•ç«¿åŠ¨ç”» |
| è§†è§‰æ•ˆæœ | é±¼ç«¿ç”©å‡ºï¼Œé±¼çº¿è½å…¥æ°´ä¸­ |
| éŸ³æ•ˆ | æŠ•ç«¿å—–å—–å£° + è½æ°´å£° |

---

### 3.3 WAITINGï¼ˆç­‰å¾…ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| æŒç»­æ—¶é—´ | 3-15 ç§’ï¼ˆéšæœºï¼‰ |
| ç©å®¶è¡Œä¸º | å¯é€‰æ‹©å–æ¶ˆï¼ˆæŒ‰ [ESC]ï¼‰ |
| è§†è§‰æ•ˆæœ | é±¼æ¼‚åœ¨æ°´é¢è½»å¾®æ‘‡æ™ƒ |
| å’¬é’©æ¦‚ç‡ | æ¯ç§’ 10% æ£€æµ‹ï¼Œ15 ç§’åå¼ºåˆ¶è§¦å‘æˆ–è¶…æ—¶ |

**å’¬é’©æ—¶æœºè®¡ç®—**ï¼š
```
baseWaitTime = Random(3, 10)  // åŸºç¡€ç­‰å¾…
bonusTime = Random(0, 5)      // é¢å¤–éšæœº
actualWaitTime = baseWaitTime + bonusTime

// æ¯ç§’æ£€æµ‹
if Random() < 0.10 then TriggerBite()
if currentTime >= actualWaitTime then TriggerBite() or Timeout()
```

---

### 3.4 HOOKEDï¼ˆå’¬é’©ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| çª—å£æ—¶é—´ | 2 ç§’ |
| ç©å®¶è¡Œä¸º | å¿…é¡»åœ¨çª—å£å†…æŒ‰æ”¶æ†é”® |
| è§†è§‰æ•ˆæœ | é±¼æ¼‚å‰§çƒˆä¸‹æ²‰ï¼Œæ°´èŠ±é£æº… |
| éŸ³æ•ˆ | ã€Œå’”å—’ã€æç¤ºéŸ³ |
| UI æç¤º | å±å¹•ä¸­å¤®é—ªçƒã€Œæ”¶æ†ï¼ã€ |

---

### 3.5 SUCCESSï¼ˆæˆåŠŸï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| æŒç»­æ—¶é—´ | 2 ç§’ï¼ˆå±•ç¤ºç»“æœï¼‰ |
| ç»“æœå¤„ç† | æ‰è½è¡¨è®¡ç®— â†’ äº§å‡ºæˆ˜åˆ©å“ â†’ é€šçŸ¥æˆ˜åˆ©å“ç³»ç»Ÿ |
| è§†è§‰æ•ˆæœ | é±¼è¢«æ‹‰å‡ºæ°´é¢ï¼Œå±•ç¤ºåŠ¨ç”» |
| UI æç¤º | æ˜¾ç¤ºé±¼å + ç¨€æœ‰åº¦ + é¦–æ¬¡å‘ç°æ ‡è®° |

---

### 3.6 FAILED / MISSEDï¼ˆå¤±è´¥ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| æŒç»­æ—¶é—´ | 1 ç§’ |
| FAILED | å’¬é’©åæœªåŠæ—¶æ”¶æ† |
| MISSED | ç­‰å¾…è¶…æ—¶æœªå’¬é’© |
| è§†è§‰æ•ˆæœ | é±¼çº¿æ”¶å›ï¼Œæ— æ”¶è· |
| UI æç¤º | ã€Œé±¼è·‘äº†...ã€æˆ–ã€Œæ²¡æœ‰é±¼ä¸Šé’©ã€ |

---

## å››ã€æ‰è½è¡¨è®¾è®¡

### 4.1 é±¼ç§æ•°æ®ï¼ˆMVPï¼‰

| ID | åç§° | ç¨€æœ‰åº¦ | æƒé‡ | åŸºç¡€æ”¶ç›Š |
|----|------|--------|------|----------|
| fish_001 | å°é²¤é±¼ | Common | 300 | 1 |
| fish_002 | è‰é±¼ | Common | 250 | 1 |
| fish_003 | é‡‘é²«é±¼ | Uncommon | 150 | 2 |
| fish_004 | é”¦é²¤ | Rare | 60 | 5 |
| fish_005 | é»„é‡‘é”¦é²¤ | Epic | 30 | 15 |

**æ³¨**ï¼šLegendary é±¼ç§åœ¨ MVP ä¸­æš‚ä¸åŠ å…¥

### 4.2 æ‰è½è®¡ç®—

```
function CalculateDrop(playerRodLevel):
    // ç¨€æœ‰åº¦åŠ æˆ
    rarityBonus = playerRodLevel * 0.05  // æ¯çº§ +5%
    
    // è°ƒæ•´æƒé‡
    adjustedWeights = []
    for fish in FishTable:
        if fish.rarity >= Rare:
            weight = fish.baseWeight * (1 + rarityBonus)
        else:
            weight = fish.baseWeight * (1 - rarityBonus * 0.5)
        adjustedWeights.append(weight)
    
    // åŠ æƒéšæœºé€‰æ‹©
    totalWeight = sum(adjustedWeights)
    roll = Random(0, totalWeight)
    
    cumulative = 0
    for i, weight in adjustedWeights:
        cumulative += weight
        if roll <= cumulative:
            return FishTable[i]
```

### 4.3 æ‰è½æ¦‚ç‡è¡¨ï¼ˆæ— åŠ æˆï¼‰

| ç¨€æœ‰åº¦ | æƒé‡ | æ¦‚ç‡ |
|--------|------|------|
| Common | 550 | 69.6% |
| Uncommon | 150 | 19.0% |
| Rare | 60 | 7.6% |
| Epic | 30 | 3.8% |

---

## äº”ã€æ“ä½œæ¸…å•

### ç©å®¶è¾“å…¥

| è¾“å…¥ | çŠ¶æ€ | è¡Œä¸º |
|------|------|------|
| [E] äº¤äº’é”® | IDLE | å¼€å§‹é’“é±¼ |
| [E] äº¤äº’é”® | HOOKED | æ”¶æ† |
| [ESC] å–æ¶ˆ | WAITING | å–æ¶ˆé’“é±¼ï¼Œè¿”å› IDLE |

### ç³»ç»Ÿè¾“å‡º

| äº‹ä»¶ | è§¦å‘æ¡ä»¶ | æ•°æ® |
|------|----------|------|
| `OnFishingStart` | è¿›å…¥ CASTING | playerId |
| `OnBiteTriggered` | è¿›å…¥ HOOKED | playerId |
| `OnFishCaught` | è¿›å…¥ SUCCESS | playerId, fishData |
| `OnFishingFailed` | è¿›å…¥ FAILED/MISSED | playerId, reason |

---

## å…­ã€åé¦ˆè®¾è®¡

### 6.1 è§†è§‰åé¦ˆ

| çŠ¶æ€ | åé¦ˆ |
|------|------|
| CASTING | æŠ•ç«¿è½¨è¿¹çº¿ + æ°´èŠ±ç²’å­ |
| WAITING | é±¼æ¼‚è½»å¾®æµ®åŠ¨ |
| HOOKED | é±¼æ¼‚ä¸‹æ²‰ + æ°´åœˆæ‰©æ•£ + å±å¹•å¾®æŒ¯ |
| SUCCESS | é±¼è·ƒå‡ºæ°´é¢ + ç¨€æœ‰åº¦å…‰æ•ˆ + æ–‡å­—å¼¹å‡º |
| FAILED | é±¼çº¿æ”¶å› + ç°è‰²æ–‡å­— |

### 6.2 éŸ³æ•ˆåé¦ˆ

| äº‹ä»¶ | éŸ³æ•ˆ |
|------|------|
| æŠ•ç«¿ | `sfx_cast.wav` |
| è½æ°´ | `sfx_splash.wav` |
| å’¬é’© | `sfx_bite_alert.wav` |
| æˆåŠŸ | `sfx_success.wav` + ç¨€æœ‰åº¦éŸ³æ•ˆ |
| å¤±è´¥ | `sfx_fail.wav` |

### 6.3 ç¨€æœ‰åº¦å·®å¼‚åŒ–åé¦ˆ

| ç¨€æœ‰åº¦ | å…‰æ•ˆé¢œè‰² | éŸ³æ•ˆå˜ä½“ | æ–‡å­—æ ·å¼ |
|--------|----------|----------|----------|
| Common | ç™½è‰² | æ ‡å‡† | æ™®é€šå­—ä½“ |
| Uncommon | ç»¿è‰² | +é“ƒå£° | ç»¿è‰²å­—ä½“ |
| Rare | è“è‰² | +å’Œå¼¦ | è“è‰² + å…‰æ™• |
| Epic | ç´«è‰² | +å·è§’ | ç´«è‰² + ç²’å­ |

---

## ä¸ƒã€å¹³è¡¡å‚æ•°è¡¨

| å‚æ•° | å€¼ | å¯è°ƒèŒƒå›´ | å½±å“ |
|------|-----|----------|------|
| `CAST_DURATION` | 0.5s | 0.3-1.0s | æµç•…æ„Ÿ |
| `MIN_WAIT_TIME` | 3s | 2-5s | èŠ‚å¥æ„Ÿ |
| `MAX_WAIT_TIME` | 15s | 10-20s | è€å¿ƒé˜ˆå€¼ |
| `BITE_WINDOW` | 2s | 1.5-3s | éš¾åº¦ |
| `RARITY_BONUS_PER_LEVEL` | 5% | 3-10% | æˆé•¿æ„Ÿ |

---

## å…«ã€UEFN å®ç°è¦ç‚¹

### Verse ä¼ªä»£ç 

```verse
fishing_system := class(creative_device):
    var State : fishing_state = fishing_state.Idle
    var CurrentFish : ?fish_data = false
    
    OnInteract(Player : agent) : void =
        case State:
            fishing_state.Idle =>
                StartCasting(Player)
            fishing_state.Hooked =>
                AttemptReel(Player)
    
    StartCasting(Player : agent) : void =
        set State = fishing_state.Casting
        PlayAnimation(CastAnimation)
        spawn:
            Sleep(0.5)
            set State = fishing_state.Waiting
            StartWaitingTimer()
    
    OnBiteTriggered() : void =
        set State = fishing_state.Hooked
        PlaySFX(BiteAlertSound)
        spawn:
            Sleep(2.0)
            if State = fishing_state.Hooked:
                set State = fishing_state.Failed
                OnFishingEnd(false)
```

---

## ä¹ã€ä¸‹ä¸€æ­¥

**é’“é±¼ç³»ç»Ÿæœºåˆ¶è®¾è®¡å®Œæˆ** âœ…

ä¸‹ä¸€ä¸ªç³»ç»Ÿï¼š`@mechanics/trophy.md` - æˆ˜åˆ©å“ç³»ç»Ÿæœºåˆ¶

---

*æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2025-12-26*
