# æµæ°´çº¿ç³»ç»Ÿæ¶æ„

> **ç‰ˆæœ¬**: 1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2026-01-02  
> **çŠ¶æ€**: è®¾è®¡ä¸­

---

## æ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº†ä¸€å¥—é€šç”¨çš„æµæ°´çº¿ç³»ç»Ÿæ¶æ„ï¼Œç”¨äºæ”¯æŒå¤šç§å·¥ä½œæµåœºæ™¯ï¼š

- **Skills çŸ¥è¯†è’¸é¦**ï¼šä»å¤–éƒ¨ä¿¡æ¯æºæç‚¼å‡ºç»“æ„åŒ–çš„ Skill æ–‡æ¡£
- **æ¸¸æˆè®¾è®¡æµæ°´çº¿**ï¼šä»æ¦‚å¿µåˆ°å®Œæ•´è®¾è®¡æ–‡æ¡£çš„è¿­ä»£æµç¨‹
- **ç³»ç»Ÿè®¾è®¡æµæ°´çº¿**ï¼šä»éœ€æ±‚åˆ°å¯è¿è¡Œä»£ç çš„å¼€å‘æµç¨‹

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **ç›®æ ‡å¯¼å‘**ï¼šæµæ°´çº¿ä¸æ˜¯ç®€å•çš„é¡ºåºæµç¨‹ï¼Œè€Œæ˜¯"åŸæ–™ â†’ äº§å“"çš„ç”Ÿäº§æ¨¡å‹
2. **å¯å›é€€**ï¼šæ”¯æŒå¾ªç¯ã€åˆ†æ”¯ã€å›é€€ç­‰å·¥ä¸šæµç¨‹ç‰¹å¾
3. **å¯è§‚æµ‹**ï¼šå…¨ç¨‹çŠ¶æ€å¯è¿½è¸ªï¼Œå¤±è´¥å¯è¯Šæ–­
4. **å¤š Agent åä½œ**ï¼šä¸åŒé˜¶æ®µå¯ç”±ä¸åŒä¸“ä¸š Agent æ‰§è¡Œ

---

## ç³»ç»Ÿæ¶æ„

### ç»„ä»¶æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            æµæ°´çº¿ç³»ç»Ÿæ¶æ„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  è§¦å‘å±‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ / å®šæ—¶è§¦å‘ / äº‹ä»¶è§¦å‘                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  è§„åˆ’å±‚ (Planner Agent)                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  planner-agent.md (gh-aw workflow)                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ è§£ææµæ°´çº¿å®šä¹‰                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ åˆ›å»ºé˜¶æ®µä»»åŠ¡ (bd create)                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ è®¾ç½®ä»»åŠ¡ä¾èµ– (--deps)                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ é€šçŸ¥è°ƒåº¦å™¨ (POST /pipeline/ready)                               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ å¿«é€Ÿé€€å‡º (é‡Šæ”¾ gh-aw æ§½ä½)                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  è°ƒåº¦å±‚ (Pipeline Scheduler)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  webhook-server/pipeline_scheduler.py (äº‘æœåŠ¡å™¨å¸¸é©»)                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ æ¥æ”¶ Planner é€šçŸ¥                                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ è½®è¯¢ä»»åŠ¡é˜Ÿåˆ— (bd ready)                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ æ£€æŸ¥ä¾èµ–æ˜¯å¦æ»¡è¶³                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ä¸²è¡Œè§¦å‘ Worker (gh aw run)                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ç­‰å¾…æ‰§è¡Œå®Œæˆ                                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ å¤„ç†å¤±è´¥é‡è¯•                                                    â”‚   â”‚
â”‚  â”‚  â””â”€â”€ æ±‡æŠ¥æœ€ç»ˆç»“æœ                                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  æ‰§è¡Œå±‚ (Worker Agents)                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  worker-agent.md (gh-aw workflow)                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ è·å–æŒ‡å®šä»»åŠ¡ (bd update --status in_progress)                  â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ æ‰§è¡Œé˜¶æ®µå·¥ä½œ                                                    â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ä¿å­˜äº§ç‰© (artifacts/ æˆ– Issue è¯„è®º)                             â”‚   â”‚
â”‚  â”‚  â””â”€â”€ å®Œæˆä»»åŠ¡ (bd close --reason "...")                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  å­˜å‚¨å±‚ (Beads + ä»“åº“)                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Beads (GitHub Issues)                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ä»»åŠ¡å®šä¹‰ (é˜¶æ®µåã€è¾“å…¥å‚æ•°)                                      â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ä»»åŠ¡çŠ¶æ€ (pending/in_progress/done/failed)                     â”‚   â”‚
â”‚  â”‚  â””â”€â”€ ä»»åŠ¡ä¾èµ– (deps: completed:<prev-task-id>)                      â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ä»“åº“æ–‡ä»¶                                                            â”‚   â”‚
â”‚  â”‚  â””â”€â”€ artifacts/<pipeline-id>/<stage>/ (é˜¶æ®µäº§ç‰©)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»„ä»¶èŒè´£

| ç»„ä»¶ | ç±»å‹ | èŒè´£ | ç”Ÿå‘½å‘¨æœŸ |
|------|------|------|---------|
| **Planner Agent** | gh-aw workflow | è§£æéœ€æ±‚ã€åˆ›å»ºä»»åŠ¡ã€è®¾ç½®ä¾èµ– | çŸ­æš‚ï¼ˆå‡ åˆ†é’Ÿï¼‰ |
| **Pipeline Scheduler** | äº‘æœåŠ¡å™¨è¿›ç¨‹ | è°ƒåº¦ä»»åŠ¡ã€è§¦å‘ Workerã€å¤„ç†å¤±è´¥ | å¸¸é©» |
| **Worker Agent** | gh-aw workflow | æ‰§è¡Œå•ä¸ªé˜¶æ®µä»»åŠ¡ | çŸ­æš‚ï¼ˆæŒ‰é˜¶æ®µï¼‰ |
| **Beads** | GitHub Issues | ä»»åŠ¡é˜Ÿåˆ—ã€çŠ¶æ€å­˜å‚¨ | æŒä¹…åŒ– |

---

## æ•°æ®æµ

### å®Œæ•´æµç¨‹

```
Step 1: è§¦å‘
         â”‚
         â”œâ”€â”€ ç”¨æˆ·: gh aw run planner-agent --input pipeline_type=skills-distill
         â”œâ”€â”€ å®šæ—¶: schedule: cron
         â””â”€â”€ äº‹ä»¶: Issue åˆ›å»ºè§¦å‘
         â”‚
         â–¼
Step 2: Planner Agent è¿è¡Œ (2-5 åˆ†é’Ÿ)
         â”‚
         â”œâ”€â”€ åˆ†ææµæ°´çº¿å®šä¹‰
         â”‚   â””â”€â”€ è¯»å– pipelines/skills-distill.yaml
         â”‚
         â”œâ”€â”€ åˆ›å»ºé˜¶æ®µä»»åŠ¡
         â”‚   â”œâ”€â”€ bd create "pipeline:p001 stage:ingest source:https://..." 
         â”‚   â”œâ”€â”€ bd create "pipeline:p001 stage:classify" --deps "stage:ingest"
         â”‚   â”œâ”€â”€ bd create "pipeline:p001 stage:extract" --deps "stage:classify"
         â”‚   â”œâ”€â”€ bd create "pipeline:p001 stage:assemble" --deps "stage:extract"
         â”‚   â””â”€â”€ bd create "pipeline:p001 stage:validate" --deps "stage:assemble"
         â”‚
         â”œâ”€â”€ é€šçŸ¥è°ƒåº¦å™¨
         â”‚   â””â”€â”€ POST https://server/pipeline/ready
         â”‚       { "pipeline_id": "p001", "stages": 5, "type": "skills-distill" }
         â”‚
         â””â”€â”€ é€€å‡º (é‡Šæ”¾ gh-aw æ§½ä½)
         â”‚
         â–¼
Step 3: è°ƒåº¦å™¨æ¥æ”¶é€šçŸ¥
         â”‚
         â”œâ”€â”€ ä¿å­˜æµæ°´çº¿çŠ¶æ€
         â”‚   â””â”€â”€ state_store.create_pipeline("p001", ...)
         â”‚
         â””â”€â”€ å¯åŠ¨è°ƒåº¦å¾ªç¯
         â”‚
         â–¼
Step 4: è°ƒåº¦å¾ªç¯ (é‡å¤ç›´åˆ°å®Œæˆæˆ–å¤±è´¥)
         â”‚
         â”œâ”€â”€ æŸ¥è¯¢å¯æ‰§è¡Œä»»åŠ¡
         â”‚   â””â”€â”€ bd ready --label "pipeline:p001" --json
         â”‚
         â”œâ”€â”€ æ£€æŸ¥ä¾èµ–
         â”‚   â””â”€â”€ å‰ç½®ä»»åŠ¡æ˜¯å¦ status=done?
         â”‚
         â”œâ”€â”€ è§¦å‘ Worker
         â”‚   â””â”€â”€ gh aw run worker-agent --input task_id=<id>
         â”‚
         â”œâ”€â”€ ç­‰å¾…å®Œæˆ
         â”‚   â””â”€â”€ è½®è¯¢ gh run view <run-id> --json status
         â”‚
         â”œâ”€â”€ æ£€æŸ¥ä»»åŠ¡ç»“æœ
         â”‚   â”œâ”€â”€ æˆåŠŸ: ç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡
         â”‚   â”œâ”€â”€ å¤±è´¥: 
         â”‚   â”‚   â”œâ”€â”€ é‡è¯•æ¬¡æ•° < 3: é‡æ–°åˆ›å»ºä»»åŠ¡
         â”‚   â”‚   â””â”€â”€ é‡è¯•æ¬¡æ•° >= 3: æ ‡è®°å¤±è´¥ï¼Œå†³å®šæ˜¯å¦ç»§ç»­
         â”‚   â””â”€â”€ è¶…æ—¶: å–æ¶ˆä»»åŠ¡ï¼Œè®°å½•é”™è¯¯
         â”‚
         â””â”€â”€ é—´éš”ç­‰å¾… (30-60 ç§’)
         â”‚
         â–¼
Step 5: å®Œæˆ
         â”‚
         â”œâ”€â”€ æ›´æ–°æµæ°´çº¿çŠ¶æ€ä¸º completed/failed
         â”œâ”€â”€ æ±‡æ€»æ‰§è¡ŒæŠ¥å‘Š
         â””â”€â”€ å¯é€‰: åˆ›å»º Issue æŠ¥å‘Š / å‘é€é€šçŸ¥
```

### çŠ¶æ€ä¼ é€’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            çŠ¶æ€ä¼ é€’æœºåˆ¶                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  æ–¹æ¡ˆ: Beads reason + ä»“åº“æ–‡ä»¶                                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Stage 1   â”‚        â”‚   Stage 2   â”‚        â”‚   Stage 3   â”‚             â”‚
â”‚  â”‚   Ingest    â”‚ â”€â”€â”€â”€â”€â–¶ â”‚   Extract   â”‚ â”€â”€â”€â”€â”€â–¶ â”‚  Assemble   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                      â”‚                      â”‚                     â”‚
â”‚         â–¼                      â–¼                      â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ bd close    â”‚        â”‚ bd close    â”‚        â”‚ bd close    â”‚             â”‚
â”‚  â”‚ --reason    â”‚        â”‚ --reason    â”‚        â”‚ --reason    â”‚             â”‚
â”‚  â”‚ "output:    â”‚        â”‚ "output:    â”‚        â”‚ "output:    â”‚             â”‚
â”‚  â”‚  ingest.jsonâ”‚        â”‚  patterns/  â”‚        â”‚  SKILL.md"  â”‚             â”‚
â”‚  â”‚  files: 5"  â”‚        â”‚  count: 10" â”‚        â”‚             â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                      â”‚                      â”‚                     â”‚
â”‚         â–¼                      â–¼                      â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  artifacts/<pipeline-id>/                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ ingest/                                                        â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ result.json                                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ extract/                                                       â”‚   â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ patterns.json                                              â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€ snippets/                                                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ assemble/                                                      â”‚   â”‚
â”‚  â”‚      â””â”€â”€ SKILL-draft.md                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## è®¾è®¡å†³ç­–

### 1. ä¸ºä»€ä¹ˆéœ€è¦äº‘æœåŠ¡å™¨è°ƒåº¦ï¼Ÿ

| é—®é¢˜ | çº¯ gh-aw æ–¹æ¡ˆ | äº‘æœåŠ¡å™¨è°ƒåº¦æ–¹æ¡ˆ |
|------|--------------|----------------|
| **gh-aw å¹¶å‘é™åˆ¶** | âŒ Orchestrator å ç”¨æ§½ä½é˜»å¡ Worker | âœ… Planner å¿«é€Ÿé€€å‡ºï¼Œä¸å æ§½ |
| **ç­‰å¾…é€»è¾‘æˆæœ¬** | âŒ Agent è½®è¯¢æ¶ˆè€—å¤§é‡ tokens | âœ… æœåŠ¡å™¨è½®è¯¢æ—  token æˆæœ¬ |
| **å¤±è´¥æ¢å¤** | âš ï¸ éœ€è¦æ•´ä¸ªæµç¨‹é‡è·‘ | âœ… å¯ä»¥åªé‡è¯•å¤±è´¥çš„ä»»åŠ¡ |
| **è¶…æ—¶æ§åˆ¶** | âš ï¸ Agent å¯èƒ½æ— é™ç­‰å¾… | âœ… æœåŠ¡å™¨å¯è®¾å®šä¸¥æ ¼è¶…æ—¶ |
| **å¯è§‚æµ‹æ€§** | âš ï¸ åªèƒ½çœ‹ Actions æ—¥å¿— | âœ… æœåŠ¡å™¨æœ‰å®Œæ•´è°ƒåº¦æ—¥å¿— |

### 2. ä»»åŠ¡ä¾èµ–è®¾è®¡

```yaml
# Beads ä»»åŠ¡ä¾èµ–è¯­æ³•
bd create "stage:extract ..." --deps "completed:stage:ingest"

# ä¾èµ–ç±»å‹
# - completed:<task>  : å‰ç½®ä»»åŠ¡å¿…é¡»æˆåŠŸå®Œæˆ
# - any:<task>        : å‰ç½®ä»»åŠ¡å®Œæˆå³å¯ï¼ˆä¸è®ºæˆåŠŸå¤±è´¥ï¼‰
# - parallel:<task>   : å¯ä»¥å¹¶è¡Œæ‰§è¡Œ
```

### 3. å¤±è´¥å¤„ç†ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å¤±è´¥å¤„ç†å†³ç­–æ ‘                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ä»»åŠ¡å¤±è´¥                                                                    â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â”œâ”€â”€ å¤±è´¥ç±»å‹?                                                          â”‚
â”‚      â”‚   â”‚                                                                  â”‚
â”‚      â”‚   â”œâ”€â”€ ä¸´æ—¶é”™è¯¯ (ç½‘ç»œã€è¶…æ—¶)                                           â”‚
â”‚      â”‚   â”‚   â””â”€â”€ é‡è¯•å½“å‰ä»»åŠ¡ (æœ€å¤š 3 æ¬¡)                                    â”‚
â”‚      â”‚   â”‚                                                                  â”‚
â”‚      â”‚   â”œâ”€â”€ è¾“å…¥ä¸è¶³ (å†…å®¹å¤ªå°‘ã€è´¨é‡å·®)                                      â”‚
â”‚      â”‚   â”‚   â””â”€â”€ å›é€€åˆ°å‰ä¸€é˜¶æ®µï¼Œè¡¥å……è¾“å…¥                                     â”‚
â”‚      â”‚   â”‚                                                                  â”‚
â”‚      â”‚   â”œâ”€â”€ é˜¶æ®µé€»è¾‘é”™è¯¯ (Agent æ‰§è¡Œé”™è¯¯)                                   â”‚
â”‚      â”‚   â”‚   â””â”€â”€ æ ‡è®°å¤±è´¥ï¼Œäººå·¥ä»‹å…¥                                          â”‚
â”‚      â”‚   â”‚                                                                  â”‚
â”‚      â”‚   â””â”€â”€ é…ç½®é”™è¯¯ (æµæ°´çº¿å®šä¹‰é—®é¢˜)                                        â”‚
â”‚      â”‚       â””â”€â”€ ç»ˆæ­¢æµæ°´çº¿ï¼ŒæŠ¥å‘Šé”™è¯¯                                         â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â””â”€â”€ é‡è¯•æ¬¡æ•° >= 3?                                                     â”‚
â”‚          â”œâ”€â”€ æ˜¯: å‡çº§åˆ°äººå·¥å¤„ç†                                              â”‚
â”‚          â””â”€â”€ å¦: æ‰§è¡Œå¯¹åº”çš„å¤±è´¥å¤„ç†ç­–ç•¥                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. äº§ç‰©å­˜å‚¨é€‰æ‹©

| é€‰é¡¹ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| **ä»“åº“ artifacts/** | æŒä¹…åŒ–ã€ç‰ˆæœ¬æ§åˆ¶ã€å¯è¿½æº¯ | éœ€è¦ PR æƒé™ | ä»£ç /æ–‡æ¡£äº§ç‰© |
| **Issue è¯„è®º** | ç®€å•ã€é›†ä¸­ç®¡ç† | å¤§æ–‡ä»¶ä¸é€‚åˆ | å…ƒæ•°æ®ã€æŠ¥å‘Š |
| **Beads reason** | æœ€ç®€å• | å®¹é‡æœ‰é™ | çŠ¶æ€æ ‡è®°ã€ç®€çŸ­æè¿° |

**æ¨èç»„åˆ**ï¼š
- å¤§å‹äº§ç‰©ï¼ˆä»£ç ã€æ–‡æ¡£ï¼‰â†’ ä»“åº“ `artifacts/`
- é˜¶æ®µå…ƒæ•°æ® â†’ Beads task reason
- æ‰§è¡ŒæŠ¥å‘Š â†’ Pipeline Issue è¯„è®º

---

## æµæ°´çº¿å®šä¹‰è§„èŒƒ

### é…ç½®æ–‡ä»¶æ ¼å¼

```yaml
# pipelines/skills-distill.yaml
name: skills-distill
description: ä»å¤–éƒ¨ä¿¡æ¯æºè’¸é¦ Skill æ–‡æ¡£
version: 1.0.0

stages:
  - id: ingest
    name: é‡‡é›†
    description: è·å–å¹¶è§£æä¿¡æ¯æºå†…å®¹
    worker: worker-agent  # ä½¿ç”¨çš„ workflow
    inputs:
      - source_url  # ä»æµæ°´çº¿å‚æ•°è·å–
    outputs:
      - artifacts/ingest/result.json
    quality_checks:
      - content_not_empty
      - valid_format
    on_fail: abort

  - id: classify
    name: åˆ†ç±»
    description: åˆ†æå†…å®¹ç±»å‹ï¼Œåˆ¤æ–­å¯æå–æ€§
    depends_on: [ingest]
    inputs:
      - artifacts/ingest/result.json
    outputs:
      - artifacts/classify/analysis.json
    quality_checks:
      - extractable_patterns >= 3
    on_fail: retry(ingest)  # å›é€€åˆ°é‡‡é›†é˜¶æ®µ

  - id: extract
    name: æå–
    description: ä»å†…å®¹ä¸­æå–å¯å¤ç”¨æ¨¡å¼
    depends_on: [classify]
    inputs:
      - artifacts/classify/analysis.json
    outputs:
      - artifacts/extract/patterns.json
      - artifacts/extract/snippets/
    quality_checks:
      - pattern_count >= 3
      - pattern_count <= 30
    on_fail: retry(classify)

  - id: assemble
    name: ç»„è£…
    description: ç”Ÿæˆ SKILL.md è‰ç¨¿
    depends_on: [extract]
    inputs:
      - artifacts/extract/patterns.json
    outputs:
      - artifacts/assemble/SKILL-draft.md
    quality_checks:
      - has_required_sections
    on_fail: retry(extract)

  - id: validate
    name: éªŒè¯
    description: è´¨é‡è¯„åˆ†å’Œæœ€ç»ˆæ£€æŸ¥
    depends_on: [assemble]
    inputs:
      - artifacts/assemble/SKILL-draft.md
    outputs:
      - artifacts/validate/report.json
      - final/SKILL.md  # æœ€ç»ˆäº§ç‰©
    quality_checks:
      - score >= 24
    on_fail: retry(assemble)

settings:
  max_retries_per_stage: 3
  stage_timeout_minutes: 30
  parallel_execution: false  # ä¸²è¡Œæ‰§è¡Œ
```

### å…¶ä»–æµæ°´çº¿ç¤ºä¾‹

```yaml
# pipelines/game-design.yaml
name: game-design
stages:
  - id: concept
  - id: mechanics
  - id: systems
  - id: balance
  - id: document

# pipelines/system-design.yaml
name: system-design
stages:
  - id: requirements
  - id: architecture
  - id: interfaces
  - id: implementation
  - id: testing
```

---

## è°ƒåº¦å™¨å®ç°ç»†èŠ‚

### Beads å­˜å‚¨æœºåˆ¶

Beads é‡‡ç”¨**åŒè½¨å­˜å‚¨**ï¼š

| å­˜å‚¨ | ä½ç½® | æ˜¯å¦å…¥ Git | ç”¨é€” |
|------|------|-----------|------|
| **SQLite DB** | `.beads/beads.db` | âŒ (.gitignore) | æœ¬åœ°å¿«é€ŸæŸ¥è¯¢ |
| **JSONL** | `.beads/issues.jsonl` | âœ… | è·¨è®¾å¤‡åŒæ­¥ |

`.beads/.gitignore` å¿½ç•¥äº† `*.db*` æ–‡ä»¶ï¼Œä½†ä¿ç•™ `issues.jsonl`ï¼š

```gitignore
# è¢«å¿½ç•¥ (ä¸å…¥ Git)
*.db
*.db-wal
*.db-shm
daemon.lock
daemon.pid
bd.sock

# è¢«è¿½è¸ª (å…¥ Git)
issues.jsonl
interactions.jsonl
config.yaml
```

### äº‘æœåŠ¡å™¨ä»“åº“åŒæ­¥ï¼ˆæ¨èæ–¹æ¡ˆï¼‰

**è®¾è®¡å†³ç­–**ï¼šäº‘æœåŠ¡å™¨ç»´æŠ¤å®Œæ•´ä»“åº“ Cloneï¼Œä¸ä½¿ç”¨"çœèµ„æº"çš„ API æ–¹æ¡ˆã€‚

**ç†ç”±**ï¼š
- ç”Ÿäº§ç¯å¢ƒç¨³å®šæ€§ä¼˜å…ˆ
- é¿å… API è§£æã€å®æ—¶æ€§ã€ä¾èµ–åˆ¤æ–­ç­‰æ½œåœ¨é—®é¢˜
- Beads CLI å®Œæ•´åŠŸèƒ½å¯ç”¨

```bash
# åˆå§‹åŒ–ï¼ˆä¸€æ¬¡æ€§ï¼‰
git clone git@github.com:<owner>/<repo>.git /opt/pipeline-repo
cd /opt/pipeline-repo

# æ¯æ¬¡è°ƒåº¦å‰åŒæ­¥
git fetch origin && git reset --hard origin/main
bd sync --import-only  # ä» JSONL å¯¼å…¥åˆ°æœ¬åœ° DB

# ä½¿ç”¨ Beads CLI æŸ¥è¯¢
bd ready --label "pipeline:p001" --json
```

**å®šæ—¶åŒæ­¥ + äº‹ä»¶è§¦å‘**ï¼š
```python
# pipeline_scheduler.py
class RepoSync:
    def __init__(self, repo_path: str):
        self.repo_path = repo_path
    
    def sync(self):
        """æ‹‰å–æœ€æ–°ä»£ç å¹¶å¯¼å…¥ Beads"""
        subprocess.run(['git', 'fetch', 'origin'], cwd=self.repo_path)
        subprocess.run(['git', 'reset', '--hard', 'origin/main'], cwd=self.repo_path)
        subprocess.run(['bd', 'sync', '--import-only'], cwd=self.repo_path)
    
    def get_ready_tasks(self, pipeline_id: str) -> list[dict]:
        """è·å–å¯æ‰§è¡Œä»»åŠ¡"""
        result = subprocess.run(
            ['bd', 'ready', '--label', f'pipeline:{pipeline_id}', '--json'],
            cwd=self.repo_path, capture_output=True
        )
        return json.loads(result.stdout) if result.stdout else []
```

### ä¿¡å·ä¼ é€’ä¸è®°å½•æœºåˆ¶

é‡‡ç”¨**HTTP ç›´æ¥é€šçŸ¥ + Issue Comment è®°å½•**çš„åŒè½¨æ¨¡å¼ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¿¡å·ä¸è®°å½•åˆ†ç¦»æ¶æ„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ä¿¡å·é€šé“ (å¿«é€Ÿ)                          è®°å½•é€šé“ (æŒä¹…)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  HTTP POST      â”‚                     â”‚  Issue Comment  â”‚               â”‚
â”‚  â”‚  /pipeline/...  â”‚                     â”‚  (æ—¶é—´çº¿è®°å½•)    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚           â”‚                                       â”‚                         â”‚
â”‚           â–¼                                       â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Pipeline Scheduler                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚ æ¥æ”¶ä¿¡å·       â”‚â”€â”€â”€â–¶â”‚ æ‰§è¡Œè°ƒåº¦       â”‚â”€â”€â”€â–¶â”‚ å†™å›è®°å½•       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚ HTTP endpoint â”‚    â”‚ è§¦å‘ Worker   â”‚    â”‚ gh issue commentâ”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è®°å½•æ ¼å¼è®¾è®¡

æ¯ä¸ªæµæ°´çº¿åˆ›å»ºä¸€ä¸ª **Pipeline Issue** ä½œä¸º"ä»ªè¡¨æ¿"ï¼Œæ‰€æœ‰äº‹ä»¶è®°å½•ä¸º Commentï¼š

```markdown
<!-- Pipeline Issue æ ‡é¢˜ -->
[Pipeline] skills-distill #p001

<!-- Issue æè¿° -->
**ç±»å‹**: skills-distill
**æ¥æº**: https://example.com/docs
**è§¦å‘æ—¶é—´**: 2026-01-02 14:30:00
**çŠ¶æ€**: ğŸ”„ è¿è¡Œä¸­

---
**é˜¶æ®µè¿›åº¦**:
- [x] ingest (å®Œæˆ)
- [ ] classify (è¿è¡Œä¸­)
- [ ] extract
- [ ] assemble
- [ ] validate
```

```markdown
<!-- Comment: é˜¶æ®µå¼€å§‹ -->
### ğŸš€ Stage Started: `classify`
**æ—¶é—´**: 2026-01-02 14:35:22
**ä»»åŠ¡ ID**: vibe-coding-cn-abc
**Worker Run**: [#12345](link-to-actions-run)
**è¾“å…¥**: `artifacts/p001/ingest/result.json` (5 files, 128KB)
```

```markdown
<!-- Comment: é˜¶æ®µå®Œæˆ -->
### âœ… Stage Completed: `classify`
**æ—¶é—´**: 2026-01-02 14:38:15
**è€—æ—¶**: 2m 53s
**è¾“å‡º**: `artifacts/p001/classify/analysis.json`
**ç»“æœæ‘˜è¦**:
- å¯æå–æ¨¡å¼: 7 ä¸ª
- æ¨èåˆ†ç±»: programming/patterns
```

```markdown
<!-- Comment: é˜¶æ®µå¤±è´¥ -->
### âŒ Stage Failed: `extract`
**æ—¶é—´**: 2026-01-02 14:42:00
**é”™è¯¯ç±»å‹**: å†…å®¹ä¸è¶³
**é‡è¯•æ¬¡æ•°**: 1/3
**ä¸‹ä¸€æ­¥**: å›é€€åˆ° classify é˜¶æ®µ

<details>
<summary>é”™è¯¯è¯¦æƒ…</summary>

```
Error: Insufficient patterns extracted (found 2, need >= 3)
Context: ...
```
</details>
```

#### è°ƒåº¦å™¨è®°å½•å®ç°

```python
# pipeline_scheduler.py
class PipelineRecorder:
    """å°†è°ƒåº¦äº‹ä»¶è®°å½•åˆ° GitHub Issue"""
    
    def __init__(self, repo: str, token: str):
        self.repo = repo
        self.headers = {
            "Authorization": f"token {token}",
            "Accept": "application/vnd.github.v3+json"
        }
    
    def create_pipeline_issue(self, pipeline_id: str, config: dict) -> int:
        """åˆ›å»ºæµæ°´çº¿ Issueï¼ˆä»ªè¡¨æ¿ï¼‰"""
        body = f"""**ç±»å‹**: {config['type']}
**æ¥æº**: {config.get('source_url', 'N/A')}
**è§¦å‘æ—¶é—´**: {datetime.now().isoformat()}
**çŠ¶æ€**: ğŸ”„ è¿è¡Œä¸­

---
**é˜¶æ®µè¿›åº¦**:
{self._render_stages(config['stages'])}
"""
        response = requests.post(
            f"https://api.github.com/repos/{self.repo}/issues",
            headers=self.headers,
            json={
                "title": f"[Pipeline] {config['type']} #{pipeline_id}",
                "body": body,
                "labels": ["pipeline", f"pipeline:{pipeline_id}"]
            }
        )
        return response.json()['number']
    
    def log_stage_event(self, issue_number: int, event_type: str, data: dict):
        """è®°å½•é˜¶æ®µäº‹ä»¶ä¸º Comment"""
        templates = {
            "started": "### ğŸš€ Stage Started: `{stage}`\n**æ—¶é—´**: {time}\n**ä»»åŠ¡ ID**: {task_id}\n**Worker Run**: [#{run_id}]({run_url})",
            "completed": "### âœ… Stage Completed: `{stage}`\n**æ—¶é—´**: {time}\n**è€—æ—¶**: {duration}\n**è¾“å‡º**: `{output}`",
            "failed": "### âŒ Stage Failed: `{stage}`\n**æ—¶é—´**: {time}\n**é”™è¯¯**: {error}\n**é‡è¯•**: {retry_count}/3",
        }
        
        body = templates[event_type].format(**data)
        requests.post(
            f"https://api.github.com/repos/{self.repo}/issues/{issue_number}/comments",
            headers=self.headers,
            json={"body": body}
        )
    
    def update_pipeline_status(self, issue_number: int, status: str, stages_progress: list):
        """æ›´æ–° Issue æè¿°ä¸­çš„çŠ¶æ€"""
        # ä½¿ç”¨ PATCH æ›´æ–° Issue body
        ...
```

#### Planner Agent HTTP é€šçŸ¥

```yaml
# planner-agent.md
network:
  allowed:
    - "your-server-domain.com"

instructions: |
  å®Œæˆä»»åŠ¡åˆ›å»ºåï¼Œé€šçŸ¥è°ƒåº¦å™¨:
  
  ```bash
  curl -X POST https://your-server/pipeline/ready \
    -H "Content-Type: application/json" \
    -H "X-Pipeline-Secret: $PIPELINE_SECRET" \
    -d '{
      "pipeline_id": "p001",
      "type": "skills-distill", 
      "stages": ["ingest", "classify", "extract", "assemble", "validate"],
      "source_url": "https://..."
    }'
  ```
```

### è°ƒåº¦å™¨è§¦å‘ Worker

```python
# pipeline_scheduler.py
def trigger_worker(task_id: str, repo_path: str) -> int:
    """è§¦å‘ Worker Agent æ‰§è¡Œä»»åŠ¡"""
    result = subprocess.run(
        ['gh', 'aw', 'run', 'worker-agent', '--input', f'task_id={task_id}'],
        cwd=repo_path,
        capture_output=True
    )
    # è¿”å› workflow run ID
    return parse_run_id(result.stdout)
```

### Action è§¦å‘æƒé™é—®é¢˜

| Token ç±»å‹ | è§¦å‘ workflow_dispatch | éœ€è¦æ‰¹å‡†ï¼Ÿ |
|-----------|----------------------|-----------|
| **GITHUB_TOKEN** | âŒ ä¸æ”¯æŒï¼ˆé˜²æ­¢å¾ªç¯ï¼‰ | - |
| **PAT (classic)** | âœ… æ”¯æŒ | å¦ï¼ˆé™¤éæœ‰ Environment ä¿æŠ¤ï¼‰ |
| **PAT (fine-grained)** | âœ… æ”¯æŒ | å¦ï¼ˆé™¤éæœ‰ Environment ä¿æŠ¤ï¼‰ |
| **GitHub App** | âœ… æ”¯æŒ | å¦ |

**æ¨èé…ç½®**ï¼š
1. åˆ›å»º PAT å¹¶æ·»åŠ ä¸ºä»“åº“ Secret (`PIPELINE_PAT`)
2. äº‘æœåŠ¡å™¨ä½¿ç”¨æ­¤ PAT è°ƒç”¨ `gh aw run`
3. ä¸è¦ä¸º Worker workflow è®¾ç½® Environment ä¿æŠ¤è§„åˆ™

### è°ƒåº¦å™¨ API è®¾è®¡

```python
# webhook-server/pipeline_scheduler.py

from fastapi import APIRouter, BackgroundTasks
from pydantic import BaseModel

router = APIRouter(prefix="/pipeline")

class PipelineReadyRequest(BaseModel):
    pipeline_id: str
    stages: int
    type: str
    source_url: str | None = None

@router.post("/ready")
async def pipeline_ready(req: PipelineReadyRequest, bg: BackgroundTasks):
    """æ¥æ”¶ Planner Agent çš„é€šçŸ¥ï¼Œå¯åŠ¨è°ƒåº¦å¾ªç¯"""
    # ä¿å­˜æµæ°´çº¿çŠ¶æ€
    state_store.create_pipeline(
        pipeline_id=req.pipeline_id,
        stages=req.stages,
        type=req.type
    )
    # åœ¨åå°å¯åŠ¨è°ƒåº¦å¾ªç¯
    bg.add_task(run_pipeline_loop, req.pipeline_id)
    return {"status": "accepted", "pipeline_id": req.pipeline_id}

@router.get("/status/{pipeline_id}")
async def pipeline_status(pipeline_id: str):
    """æŸ¥è¯¢æµæ°´çº¿çŠ¶æ€"""
    return state_store.get_pipeline(pipeline_id)

@router.post("/retry/{pipeline_id}")
async def pipeline_retry(pipeline_id: str, stage: str = None):
    """é‡è¯•å¤±è´¥çš„é˜¶æ®µ"""
    ...
```

### è°ƒåº¦å¾ªç¯ä¼ªä»£ç 

```python
async def run_pipeline_loop(pipeline_id: str):
    """è°ƒåº¦å¾ªç¯ä¸»é€»è¾‘"""
    while True:
        # 1. è·å–å¯æ‰§è¡Œä»»åŠ¡
        tasks = get_ready_tasks(pipeline_id)
        
        if not tasks:
            if all_stages_complete(pipeline_id):
                mark_pipeline_complete(pipeline_id)
                break
            elif any_stage_failed(pipeline_id):
                handle_pipeline_failure(pipeline_id)
                break
            else:
                # ç­‰å¾…ä¾èµ–å®Œæˆ
                await asyncio.sleep(30)
                continue
        
        # 2. æ‰§è¡Œä»»åŠ¡ï¼ˆä¸²è¡Œï¼‰
        for task in tasks:
            try:
                run_id = trigger_worker(task['id'])
                await wait_for_completion(run_id, timeout=30*60)
                
                # æ£€æŸ¥ç»“æœ
                if worker_succeeded(run_id):
                    mark_task_complete(task['id'])
                else:
                    handle_task_failure(task, pipeline_id)
                    
            except TimeoutError:
                cancel_workflow(run_id)
                handle_task_failure(task, pipeline_id)
        
        # 3. åŒæ­¥çŠ¶æ€
        sync_beads_state()
```

---

## å®ç°è®¡åˆ’

### Phase 1: åŸºç¡€æ¡†æ¶

- [ ] åˆ›å»º `pipelines/` ç›®å½•ï¼Œæ·»åŠ é…ç½®æ–‡ä»¶è§„èŒƒ
- [ ] æ‰©å±• `webhook-server/` æ·»åŠ  `pipeline_scheduler.py`
- [ ] æ·»åŠ  `/pipeline/ready` å’Œ `/pipeline/status` è·¯ç”±
- [ ] å®ç°åŸºç¡€è°ƒåº¦å¾ªç¯

### Phase 2: Agent Workflows

- [ ] åˆ›å»º `planner-agent.md` æ¨¡æ¿
- [ ] åˆ›å»º `worker-agent.md` æ¨¡æ¿
- [ ] å®šä¹‰é˜¶æ®µä»»åŠ¡çš„æ ‡ç­¾è§„èŒƒ

### Phase 3: ç¬¬ä¸€ä¸ªæµæ°´çº¿

- [ ] å®ç° `skills-distill` æµæ°´çº¿å®šä¹‰
- [ ] æµ‹è¯•ç«¯åˆ°ç«¯æµç¨‹
- [ ] ä¼˜åŒ–é”™è¯¯å¤„ç†

### Phase 4: æ‰©å±•

- [ ] æ·»åŠ  `game-design` æµæ°´çº¿
- [ ] æ·»åŠ  `system-design` æµæ°´çº¿
- [ ] æ”¯æŒå¹¶è¡Œæ‰§è¡Œæ¨¡å¼

---

## ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `scripts/webhook-server/pipeline_scheduler.py` | æµæ°´çº¿è°ƒåº¦å™¨ï¼ˆå¾…åˆ›å»ºï¼‰ |
| `.github/workflows/planner-agent.md` | è§„åˆ’ Agentï¼ˆå¾…åˆ›å»ºï¼‰ |
| `.github/workflows/worker-agent.md` | æ‰§è¡Œ Agentï¼ˆå·²æœ‰ beads-agent å¯å¤ç”¨ï¼‰ |
| `pipelines/*.yaml` | æµæ°´çº¿å®šä¹‰ï¼ˆå¾…åˆ›å»ºï¼‰ |
| `artifacts/<pipeline-id>/` | äº§ç‰©å­˜å‚¨ç›®å½• |

---

## å˜æ›´å†å²

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´å†…å®¹ |
|------|------|---------|
| 2026-01-02 | 1.0.0 | åˆå§‹æ¶æ„è®¾è®¡ |
