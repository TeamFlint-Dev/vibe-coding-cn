# 全局注册表

## 概述

全局注册表是 Skill 系统的发现层，让 Agent 能够快速找到需要的 Skill。

## 注册表结构

### 注册表文件

建议在 `Core/skills/` 目录下维护 `@registry.md`：

```markdown
# Skill 注册表

## 索引

| Skill | 路径 | 标签 | 状态 |
|-------|------|------|------|
| verseDev | programming/verseDev | verse, uefn | stable |
| verseComponent | programming/verseDev/verseComponent | verse, component | stable |
| gameDev | design/gameDev | game-design | stable |
| ... | ... | ... | ... |

## 按标签分类

### verse
- [verseDev](programming/verseDev/SKILL.md)
- [verseComponent](programming/verseDev/verseComponent/SKILL.md)
- ...

### game-design
- [gameDev](design/gameDev/SKILL.md)
- ...
```

### 注册项格式

每个 Skill 在注册表中的条目：

```yaml
- name: verseComponent
  path: programming/verseDev/verseComponent
  description: "当需要开发 Verse 组件时..."
  tags:
    - verse
    - component
    - scenegraph
  status: stable
  complexity: medium
  capabilities:
    - 组件设计
    - 组件编码
    - 组件审计
```

## 发现机制

### 按路径发现

直接通过路径定位：

```
Core/skills/programming/verseDev/verseComponent/SKILL.md
```

### 按标签发现

通过标签搜索相关 Skill：

```markdown
## 查找标签为 "verse" 的 Skill

1. 读取注册表
2. 过滤 tags 包含 "verse" 的条目
3. 返回匹配列表
```

### 按能力发现

通过能力描述语义搜索：

```markdown
## 查找能"开发组件"的 Skill

1. 在注册表中搜索 capabilities
2. 语义匹配 "开发组件"
3. 返回匹配列表（如 verseComponent）
```

### 按场景发现

通过场景描述匹配：

```markdown
## 查找适合"创建钓鱼游戏"的 Skill

1. 分析场景关键词：游戏、钓鱼
2. 匹配 description 或 tags
3. 返回可能的 Skill 列表
```

## 标签规范

### 标签类型

| 类型 | 示例 | 用途 |
|------|------|------|
| 技术栈 | `verse`, `python`, `typescript` | 标识技术领域 |
| 功能类 | `component`, `event`, `helper` | 标识功能类型 |
| 领域类 | `game-dev`, `web-dev` | 标识应用领域 |
| 层级类 | `orchestrator`, `auditor` | 标识 Skill 角色 |

### 标签命名

- 使用小写
- 多词用连字符分隔
- 保持简短（1-2 个词）
- 使用常见术语

```
✅ verse, game-dev, component
❌ VerseProgramming, GameDevelopmentSkill
```

### 常用标签列表

```markdown
## 技术栈标签
- verse
- uefn
- python
- typescript

## 功能类标签
- component
- event
- helper
- manager
- wrapper

## 角色类标签
- orchestrator  # 编排器
- auditor       # 审计器
- creator       # 创建器
- designer      # 设计器

## 领域类标签
- game-dev
- scenegraph
- api
- architecture
```

## 注册表维护

### 自动更新

当 Skill 发生变更时自动更新注册表：

```
Skill 变更
│
├─ 新增 Skill
│   └─ 添加注册项
│
├─ 更新 Skill
│   └─ 更新相关字段（tags, status, etc.）
│
├─ 废弃 Skill
│   └─ 更新 status 为 deprecated
│
└─ 删除 Skill
    └─ 移除注册项
```

### 一致性检查

定期验证注册表与实际 Skill 的一致性：

```markdown
## 一致性检查清单

- [ ] 所有 Skill 目录都有注册项
- [ ] 所有注册项都有对应目录
- [ ] 路径正确可访问
- [ ] status 与 Frontmatter 一致
- [ ] tags 反映实际能力
```

## 搜索接口

### 查询语法建议

```markdown
## 查询示例

### 按标签
tag:verse                    # 包含 verse 标签
tag:verse AND tag:component  # 同时包含两个标签
tag:verse OR tag:python      # 包含任一标签

### 按状态
status:stable               # 稳定状态的 Skill
status:deprecated           # 已废弃的 Skill

### 按复杂度
complexity:low              # 低复杂度
complexity:high             # 高复杂度

### 组合查询
tag:verse AND status:stable AND complexity:medium
```

### 返回格式

```yaml
results:
  - name: verseComponent
    path: programming/verseDev/verseComponent
    relevance: 0.95
    summary: "组件开发技能，支持创建、编码和审计"
    
  - name: verseEventFlow
    path: programming/verseDev/verseEventFlow
    relevance: 0.72
    summary: "事件流设计技能"
```

## 与 Agent 的集成

### Agent 如何使用注册表

```markdown
## 使用流程

1. Agent 接收任务
2. 分析任务关键词
3. 查询注册表获取候选 Skill
4. 读取候选 Skill 的 When to Use
5. 选择最匹配的 Skill
6. 加载并执行
```

### 注册表作为入口点

Agent 可以将注册表作为 Skill 系统的入口点：

```markdown
## 任务入口

当收到开发任务时：
1. 首先读取 Core/skills/@registry.md
2. 根据任务特征定位候选 Skill
3. 逐个评估直到找到匹配
```

---

**相关文档**：
- [能力声明](能力声明.md)
- [上下文揭露](../基础规范/上下文揭露.md)
- [元数据规范](../基础规范/元数据规范.md)
