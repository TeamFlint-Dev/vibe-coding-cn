# 代谢动作

代谢动作是重构者对 Skill 执行的具体操作，分为三大类：合成、转化、分解。

## 动作分类

```
代谢动作
├── 合成代谢（Anabolism）—— 增加
│   ├── 生长：新建 Skill
│   └── 扩展：增加内容
│
├── 转化代谢（Transformation）—— 变形
│   ├── 更新：修正过时内容
│   ├── 锐化：明确边界描述
│   ├── 拆分：一个变多个
│   └── 合并：多个变一个
│
└── 分解代谢（Catabolism）—— 减少
    ├── 精炼：去除冗余
    ├── 遗忘：标记废弃
    └── 删除：彻底移除
```

## 合成代谢

### 生长（Growth）

**触发信号**：`missing` × N

**场景**：某个能力需求反复出现，但找不到对应的 Skill。

**动作**：

1. 分析 missing 信号的 evidences
2. 确定新 Skill 的位置（父节点）
3. 创建新 Skill 目录和 SKILL.md
4. 设置 `status: draft`
5. 记录重构日志

**示例**：

```markdown
信号：missing × 3
  - "找不到网络同步相关的 Skill"
  - "需要处理多人游戏状态同步"
  - "RPC 调用没有参考"

动作：在 verseDev/ 下新建 verseNetSync/
```

### 扩展（Extension）

**触发信号**：`missing` × N（但指向已有 Skill 的子能力）

**场景**：已有 Skill 覆盖了大部分需求，但缺少某个子能力。

**动作**：

1. 在目标 Skill 中添加新章节或子目录
2. 更新 Context Entry
3. 版本号 minor +1

## 转化代谢

### 更新（Update）

**触发信号**：`outdated` × N

**场景**：Skill 内容与当前实际不符。

**动作**：

1. 识别过时内容
2. 更新为最新信息
3. 验证示例代码可运行
4. 版本号 patch +1

**检查清单**：

```markdown
- [ ] 示例代码在最新环境可运行
- [ ] API 引用与当前版本一致
- [ ] 链接仍然有效
- [ ] 术语与官方文档一致
```

### 锐化（Sharpen）

**触发信号**：`unclear` × N

**场景**：Agent 在多个 Skill 之间反复切换，说明边界描述不够清晰。

**动作**：

1. 分析 unclear 信号涉及的 Skill 对
2. 重写 When to Use 章节
3. 明确 ✅ 适用 和 ❌ 不适用 的对比
4. 添加与相关 Skill 的区分说明

**锐化模板**：

```markdown
## When to Use

### ✅ 适用场景

当满足以下条件时，使用此 Skill：
- 具体条件 1
- 具体条件 2

### ❌ 不适用场景

以下情况应使用其他 Skill：
- 场景 A → 使用 [OtherSkill](path/to/other)
- 场景 B → 使用 [AnotherSkill](path/to/another)

### 与 [RelatedSkill] 的区别

| 维度 | 本 Skill | RelatedSkill |
|------|---------|--------------|
| 关注点 | ... | ... |
| 输出 | ... | ... |
| 适用阶段 | ... | ... |
```

### 拆分（Split）

**触发信号**：`overload` × N

**场景**：一个 Skill 承担了过多职责，内容庞大难以定位。

**动作**：

1. 识别可独立的职责边界
2. 创建子 Skill 目录
3. 迁移相关内容
4. 原 Skill 保留概述和导航
5. 更新 Children 章节
6. 版本号 major +1

**示例**：

```
拆分前：
verseComponent/
├── SKILL.md  # 包含基础组件 + 高级组件 + 组件模式

拆分后：
verseComponent/
├── SKILL.md              # 概述 + 导航
├── verseBasicComponent/  # 基础组件
├── verseAdvancedComponent/  # 高级组件
└── verseComponentPatterns/  # 组件模式
```

### 合并（Merge）

**触发信号**：`conflict` × N

**场景**：多个 Skill 职责重叠，造成选择困难。

**动作**：

1. 识别重叠的内容
2. 确定合并目标（保留哪个）
3. 整合内容，去除重复
4. 被合并的 Skill 标记 `deprecated`
5. 添加重定向说明
6. 过渡期后删除

**合并判定**：

```
是否应该合并？
├─ 两个 Skill 经常一起使用 → 考虑合并
├─ 一个是另一个的特例 → 考虑合并为父子
├─ 各有独立价值但有重叠 → 划清边界而非合并
└─ 完全不同只是名字像 → 锐化而非合并
```

## 分解代谢

### 精炼（Refine）

**触发信号**：重构者主动发现，或 `overload` 的轻度情况

**场景**：内容臃肿但不需要拆分，去除冗余即可。

**动作**：

1. 识别重复或低价值内容
2. 压缩或删除
3. 优化结构
4. 版本号 patch +1

### 遗忘（Deprecate）

**触发信号**：`unused` × 30 天

**场景**：Skill 长期未被使用，可能已过时或被替代。

**动作**：

1. 确认没有依赖此 Skill 的其他 Skill
2. 设置 `status: deprecated`
3. 添加废弃原因和替代方案（如有）
4. 保留观察期（如 3 个月）

**废弃声明**：

```yaml
---
status: deprecated
deprecatedReason: "已被 verseComponentV2 替代"
replacement: "verseDev/verseComponentV2"
deprecatedDate: 2026-01-02
---
```

```markdown
> ⚠️ **此 Skill 已废弃**
> 
> 原因：已被 verseComponentV2 替代
> 替代方案：[verseComponentV2](../verseComponentV2/SKILL.md)
> 将于 2026-04-02 删除
```

### 删除（Delete）

**触发信号**：废弃超过观察期，无活跃依赖

**动作**：

1. 最终确认无依赖
2. 备份到归档目录（可选）
3. 删除目录
4. 更新父 Skill 的 Children
5. 更新全局注册表

## 重构日志

每次代谢动作都应记录日志：

```markdown
# 重构日志

## 2026-01-02 - 锐化 verseComponent

### 触发信号
- Issue: #42
- Type: unclear
- Count: 4
- Target: verseDev/verseComponent

### 执行动作
锐化 When to Use 边界，明确与 verseHelpers 的区别

### 变更内容
- 重写 SKILL.md 的 When to Use 章节
- 添加与 verseHelpers 的对比表

### 效果待观察
- 后续是否还有 unclear 信号
- 选择犹豫是否减少

---

## 2026-01-01 - 更新 verseHelpers

### 触发信号
- Issue: #38
- Type: outdated
- Count: 2

### 执行动作
更新示例代码以适配 UEFN 5.x

### 变更内容
- 更新 templates/ 下的示例文件
- 更新 SKILL.md 中的代码片段

### 效果验证
Issue #38 已关闭，无新的 outdated 信号
```

---

**相关文档**：

- [代谢主体](代谢主体.md)
- [信号机制](信号机制.md)
- [调度规则](调度规则.md)
