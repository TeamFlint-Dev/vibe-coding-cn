{
  "lessons": [
    {
      "id": "LESSON-001",
      "error": "error:3532:The enumerator ... is ambiguous with this definition: function ...",
      "context": "在定义 enum 时，enum 值名称与模块中已存在的函数名称相同，导致名称冲突。例如：enum 中有 EaseLinear，而模块中也有函数 EaseLinear(T:float):float",
      "solution": "使用不同的命名模式避免冲突。例如：enum 值加前缀 'Curve' → CurveLinear, CurveInSine 等，与函数名 EaseLinear, EaseInSine 区分开",
      "prevention": "在定义 enum 前，先检查模块中是否有同名函数。如果是为现有函数创建 enum，使用描述性前缀（如 Curve*, Type*, Kind*）区分 enum 值和函数名",
      "date": "2026-01-12",
      "tags": ["ambiguous-identifier", "naming", "enum", "common"]
    },
    {
      "id": "LESSON-002",
      "error": "error:3512:This invocation calls a function that has the 'no_rollback' effect, which is not allowed by its context",
      "context": "在不带任何效果标注的函数中调用了具有 <no_rollback> 效果的函数（如 Sin, Cos, Pow）。无效果标注的函数默认只允许 <computes> 效果",
      "solution": "在函数签名中添加允许的效果。例如：让编译器推断效果（不标注），或明确允许特定效果。注意：<transacts> 实际上包含了大多数效果，包括 <decides> 和 <no_rollback>",
      "prevention": "理解 Verse 效果层次：<transacts> 是最强大的效果，包含 <decides>。如果函数需要调用可能失败的操作或有副作用的函数，让编译器推断效果或使用 <transacts>",
      "date": "2026-01-12",
      "tags": ["effect-mismatch", "no_rollback", "effect-inference", "intermediate"],
      "correction": "2026-01-12 - 修正：原记录错误地认为 <decides> 与 <transacts> 不兼容。实际上 <transacts> 包含 <decides> 效果，两者可以一起使用"
    },
    {
      "id": "LESSON-003",
      "error": "error:3512:This invocation calls a function that has the 'decides' effect, which is not allowed by its context",
      "context": "在 <computes> 或无效果标注的函数中尝试使用数组索引（如 Config.Params[0]），数组索引有 <decides> 效果（可能失败），但不在允许 <decides> 的上下文中",
      "solution": "使用 if-then-else 结构来处理可能失败的操作：if: P0 := Array[0] then: UseP0 else: DefaultValue。这创建了一个 failure context。或者在函数签名中声明 <transacts><decides> 效果组合",
      "prevention": "访问数组元素前，要么使用 if 结构提供 failure context，要么在函数签名中声明 <transacts><decides>。注意：<decides> 通常需要 <transacts> 配合使用",
      "date": "2026-01-12",
      "tags": ["decides", "array-access", "effect-mismatch", "common"],
      "correction": "2026-01-12 - 修正：<decides> 效果通常与 <transacts> 一起使用，而非互斥"
    },
    {
      "id": "LESSON-004",
      "error": "error:3509:No overload of the function `operator'+'` matches the provided arguments (:type{0.000000},:int) or (:int,:type{0.000000})",
      "context": "尝试对 int 和 float 字面量进行运算（如 I + 0.0 或 0.0 + ClampedNum），Verse 不支持隐式类型转换",
      "solution": "使用 Floor 函数显式转换：Floor(I + 0.0) 将 int 转为 float，或 Floor(0.0 + I)。Floor 接受 float 返回 int，但这里用于类型转换",
      "prevention": "在进行混合类型运算前，明确使用类型转换函数。记住 Verse 的类型系统是严格的，int 和 float 不能隐式混合",
      "date": "2026-01-12",
      "tags": ["type-error", "int-float-conversion", "operators", "beginner"]
    }
  ],
  "_metadata": {
    "description": "Verse Logic Lab 编译经验教训库",
    "usage": "记录编译错误、解决方案和预防措施",
    "tags_guide": {
      "error_types": ["type-error", "effect-mismatch", "ambiguous-identifier", "undefined-identifier", "syntax-error", "decides", "no_rollback"],
      "difficulty": ["beginner", "intermediate", "advanced"],
      "frequency": ["common", "rare"],
      "domains": ["naming", "effects", "types", "imports", "syntax", "enum", "array-access", "operators"]
    },
    "template": {
      "id": "LESSON-xxx (使用递增编号)",
      "error": "完整的错误信息（包括错误代码）",
      "context": "什么情况下发生的，相关代码片段",
      "solution": "如何修复，具体步骤",
      "prevention": "如何预防，最佳实践",
      "date": "YYYY-MM-DD",
      "tags": ["标签1", "标签2"]
    }
  }
}
