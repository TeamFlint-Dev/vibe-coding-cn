{
  "lessons": [
    {
      "id": "LESSON-001",
      "error": "error:3532:The enumerator ... is ambiguous with this definition: function ...",
      "context": "在定义 enum 时，enum 值名称与模块中已存在的函数名称相同，导致名称冲突。例如：enum 中有 EaseLinear，而模块中也有函数 EaseLinear(T:float):float",
      "solution": "使用不同的命名模式避免冲突。例如：enum 值加前缀 'Curve' → CurveLinear, CurveInSine 等，与函数名 EaseLinear, EaseInSine 区分开",
      "prevention": "在定义 enum 前，先检查模块中是否有同名函数。如果是为现有函数创建 enum，使用描述性前缀（如 Curve*, Type*, Kind*）区分 enum 值和函数名",
      "date": "2026-01-12",
      "tags": ["ambiguous-identifier", "naming", "enum", "common"]
    },
    {
      "id": "LESSON-002",
      "error": "error:3512:This invocation calls a function that has the 'no_rollback' effect, which is not allowed by its context",
      "context": "在 <transacts> 函数中调用了具有 <no_rollback> 效果的函数（如 Sin, Cos, Pow）。Verse 的效果系统不允许在 transacts 上下文中调用 no_rollback 函数",
      "solution": "将函数效果改为匹配被调用函数的效果，或者重构代码避免效果冲突。例如：将原本的 <transacts> 函数拆分为纯计算部分（可调用 no_rollback 函数）和事务部分（处理可变状态）",
      "prevention": "设计函数时，优先使用最少的效果。如果函数主要是数学计算，使用 <computes> 或不标注效果（让编译器推断）。只在真正需要事务性操作时使用 <transacts>",
      "date": "2026-01-12",
      "tags": ["effect-mismatch", "no_rollback", "transacts", "intermediate"]
    },
    {
      "id": "LESSON-003",
      "error": "error:3512:This invocation calls a function that has the 'decides' effect, which is not allowed by its context",
      "context": "在 <computes> 函数中尝试使用数组索引（如 Config.Params[0]），数组索引有 <decides> 效果（可能失败），但不在 failure context 中",
      "solution": "使用 if-then-else 结构来处理可能失败的操作：if: P0 := Array[0] then: UseP0 else: DefaultValue。这创建了一个 failure context",
      "prevention": "访问数组元素前，要么使用 if 结构，要么在函数签名中声明 <decides> 效果。对于需要安全访问的场景，考虑先验证数组长度",
      "date": "2026-01-12",
      "tags": ["decides", "array-access", "effect-mismatch", "common"]
    },
    {
      "id": "LESSON-004",
      "error": "error:3509:No overload of the function `operator'+'` matches the provided arguments (:type{0.000000},:int) or (:int,:type{0.000000})",
      "context": "尝试对 int 和 float 字面量进行运算（如 I + 0.0 或 0.0 + ClampedNum），Verse 不支持隐式类型转换",
      "solution": "使用 Floor 函数显式转换：Floor(I + 0.0) 将 int 转为 float，或 Floor(0.0 + I)。Floor 接受 float 返回 int，但这里用于类型转换",
      "prevention": "在进行混合类型运算前，明确使用类型转换函数。记住 Verse 的类型系统是严格的，int 和 float 不能隐式混合",
      "date": "2026-01-12",
      "tags": ["type-error", "int-float-conversion", "operators", "beginner"]
    }
  ],
  "_metadata": {
    "description": "Verse Logic Lab 编译经验教训库",
    "usage": "记录编译错误、解决方案和预防措施",
    "tags_guide": {
      "error_types": ["type-error", "effect-mismatch", "ambiguous-identifier", "undefined-identifier", "syntax-error", "decides", "no_rollback"],
      "difficulty": ["beginner", "intermediate", "advanced"],
      "frequency": ["common", "rare"],
      "domains": ["naming", "effects", "types", "imports", "syntax", "enum", "array-access", "operators"]
    },
    "template": {
      "id": "LESSON-xxx (使用递增编号)",
      "error": "完整的错误信息（包括错误代码）",
      "context": "什么情况下发生的，相关代码片段",
      "solution": "如何修复，具体步骤",
      "prevention": "如何预防，最佳实践",
      "date": "YYYY-MM-DD",
      "tags": ["标签1", "标签2"]
    }
  }
}
